<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "cloudstack.ent">
%BOOK_ENTITIES;
]>
<!-- Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at
http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<book>
    <xi:include href="Book_Info_Release_Notes_4-0.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
    <xi:include href="Preface.xml" xmlns:xi="http://www.w3.org/2001/XInclude"/>
    <chapter id="welcome-4.1">
        <title>Welcome to &PRODUCT; 4.1</title>
        <para>Welcome to the 4.1.1 release of &PRODUCT;, the first bug fix release of &PRODUCT; in the 4.1.x line.</para>
        <para>This document contains information specific to this release of &PRODUCT;, including upgrade instructions from prior releases and issues fixed in the release. For installation instructions, please see the <ulink url="http://cloudstack.apache.org/docs/en-US/Apache_CloudStack/4.1.1/html/Installation_Guide/index.html">Installation Guide</ulink>. For usage and administration instructions, please see the <ulink url="http://cloudstack.apache.org/docs/en-US/Apache_CloudStack/4.1.1/html/Admin_Guide/index.html">&PRODUCT; Administrator's Guide</ulink>. Developers and users who wish to work with the API will find instruction in the <ulink url="http://cloudstack.apache.org/docs/en-US/Apache_CloudStack/4.0.1-incubating/html/API_Developers_Guide/index.html">&PRODUCT; API Developer's Guide</ulink></para>
        <para>If you find any errors or problems in this guide, please see <xref linkend="feedback" />. We hope you enjoy working with &PRODUCT;!</para>
    </chapter>
    <chapter id="compatibility">
        <title>Compatibility Matrix for 4.1.1</title>
            <para>&PRODUCT; is tested against certain operating systems, hypervisors, and other components to ensure that it works on specific platforms. It may work well on other platforms, but the platforms listed below are the ones we specifically test against and are more likely to be able to help troubleshoot if you run into any issues.</para>
            <section id="supported-oses">
                <title>Supported Operating Systems</title>
                <para>This section lists the operating systems that are supported for running &PRODUCT;'s Management Server.</para>
                <para>Note that we test against specific versions of the OSes, so compatibility with CentOS 6.3 may not indicate compatibility with CentOS 6.2, etc.</para>
                <itemizedlist>
                    <listitem><para>CentOS 6.3</para></listitem>
                    <listitem><para>Red Hat Enterprise Linux 6.3</para></listitem>
                    <listitem><para>Ubuntu 12.04 LTS</para></listitem>
                </itemizedlist>
            </section>
            <section id="supported-hypervisors">
                <title>Supported Hypervisors</title>
                <para>&PRODUCT; supports three hypervisor families, Xen with XAPI, KVM, and VMware with vSphere.</para>
                <itemizedlist>
                    <listitem><para>CentOS 6.2 with KVM</para></listitem>
                    <listitem><para>Red Hat Enterprise Linux 6.2 with KVM</para></listitem>
                    <listitem><para>XenServer 6.0.2 (with Hotfix)</para></listitem>
                    <listitem><para>XenServer 6.1</para></listitem>
                    <listitem><para>VMware vSphere/Vcenter 5.1</para></listitem>
                </itemizedlist>
                <note>
                    <title>Bare Metal Support</title>
                    <para>Bare metal support is not present in this release.</para>
                </note>
            </section>
            <section id="supported-browsers">
                <title>Supported Browsers</title>
                <para>The &PRODUCT; Web-based UI should be compatible with any modern browser, but it's possible that some browsers will not render portions of the UI reliably, depending on their support of Web standards. For best results, we recommend one of the following browsers.</para>
                <itemizedlist>
                    <listitem><para>Internet Explorer 8</para></listitem>
                    <listitem><para>Firefox 10+</para></listitem>
                    <listitem><para>Chrome</para></listitem>
                    <listitem><para>Safari</para></listitem>
                </itemizedlist>
                <para>Note that it's difficult to confirm specific browser versions for Firefox and Google Chrome, given the speed of their update cycle.</para>
            </section>
            <section id="supported-devices">
                <title>External Devices</title>
                <para>The following external devices are supported in &PRODUCT; 4.1.1.</para>
                <itemizedlist>
                    <listitem><para>F5: 10.1.10 (Build 3341.1084)</para></listitem>
                    <listitem><para>SRX model srx100b: Must be 10.3 or higher -10.4R7.5</para></listitem>
                    <listitem><para>Netscaler VPX 9.3, 10.0(Build 54.7.nc and 54.161)</para></listitem>
                    <listitem><para>Netscaler MPX 10</para></listitem>
                    <listitem><para>Netscaler SDX 10</para></listitem>
                </itemizedlist>
            </section>
    </chapter>
    <chapter id="version-4.1">
        <title>Version 4.1.1</title>
        <section id="issues-fixed-4.1.1">
            <title>Issues Fixed in 4.1.1</title>
            <para>&PRODUCT; uses <ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK">Jira</ulink>
                to track its issues. All bugs for 4.1.1 have been tracked in Jira, and have 
                a standard naming convention of "CLOUDSTACK-NNNN" where "NNNN" is the issue number.</para>
            <para>This section includes a summary of known issues against 4.1.0 that were fixed in 4.1.1. Approximately 36 bugs were resolved or closed in the 4.1.1 cycle.</para>
            <informaltable>
                <tgroup cols="2" align="left" colsep="1" rowsep="1">
                    <colspec colwidth="1*" colname="1" colnum="1"/>
                    <colspec colwidth="2*" colname="2" colnum="2"/>
                    <thead>
                        <row>
                            <entry>
                                <para>Defect</para>
                            </entry>
                            <entry>
                                <para>Description</para>
                            </entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-531</para>
                            </entry>
                            <entry>
                                <para>Potential disaster with template-cleanup enabled!</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-2523</para>
                            </entry>
                            <entry>
                                <para>Object_Store_Refactor - Recurring Snapshots are failing because of NullPointerException.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-2758</para>
                            </entry>
                            <entry>
                                <para>cloudstack-management does not start from RPM packages</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-2905</para>
                            </entry>
                            <entry>
                                <para>Recurring Snapshots are failing becuase of NullPointerException.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-3005</para>
                            </entry>
                            <entry>
                                <para>Upgrade from 2.2.14 to 4.1.0 failed with "Storage volume not found: no storage vol with matching name"</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-3015</para>
                            </entry>
                            <entry>
                                <para>VPC virtual router lists deleted nics</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-3097</para>
                            </entry>
                            <entry>
                                <para>Installation docs have the wrong package names</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-3278</para>
                            </entry>
                            <entry>
                                <para>In non-OSS build, jetty:run does not upgrade the database to 4.1.0 and 4.1.1</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-1353</para>
                            </entry>
                            <entry>
                                <para>KVM 6.3 snapshot Scheduling snapshot failed due to java.lang.NullPointerException</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-3004</para>
                            </entry>
                            <entry>
                                <para>[script] ssvm_check remove the duplicate file from consoleproxy and include the script from secondary storage folder while packing iso</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-3080</para>
                            </entry>
                            <entry>
                                <para>listVirtualMachines tag search refinement no longer working</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-3179</para>
                            </entry>
                            <entry>
                                <para>[DOC] Service cloud-management should be changed to service cloudstack-management</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-3180</para>
                            </entry>
                            <entry>
                                <para>[DOC] Path /usr/lib64/cloud/common/ for CentOS should be changed to /usr/share/cloudstack-common</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-3182</para>
                            </entry>
                            <entry>
                                <para>[DOC] Path /etc/cloud should be changed to /etc/cloudstack</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-3440</para>
                            </entry>
                            <entry>
                                <para>Action events are not published due to conflict of Eventutils and ActionEventUtils files</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-3456</para>
                            </entry>
                            <entry>
                                <para>We need to proactively close XAPI initiated console session from console proxy to avoid Deny of Service behave to XenServer host</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-3540</para>
                            </entry>
                            <entry>
                                <para>edithosts.sh script may delete the active dhcphosts.txt entry</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-305</para>
                            </entry>
                            <entry>
                                <para>AWS APi - "Rolling back the transaction" seen in management server logs , everytime a soap call is made.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-308</para>
                            </entry>
                            <entry>
                                <para>ec2-describe-instances - Instance type is always retuned as "m1.small"</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-1475</para>
                            </entry>
                            <entry>
                                <para>RegisterISO error after Update SSL Certificate</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-1759</para>
                            </entry>
                            <entry>
                                <para>PF test cases failing with error "unexpected keyword argument 'keyPairFileLocation'"</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-1760</para>
                            </entry>
                            <entry>
                                <para>[Automation] Router test cases failed while checking dnsmasq service status</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-2551</para>
                            </entry>
                            <entry>
                                <para>Update Quick Install Guide</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-2893</para>
                            </entry>
                            <entry>
                                <para>The Agent attempts to re-create a already existing Libvirt Storage pool when creating a volume</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-2936</para>
                            </entry>
                            <entry>
                                <para>Disallow special characters on all text fields</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-3213</para>
                            </entry>
                            <entry>
                                <para>ResourceStateEvents for user VM are generated with entity type as Network</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-3328</para>
                            </entry>
                            <entry>
                                <para>cloudstack-agent RPM package doesn't require qemu-kvm</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-3407</para>
                            </entry>
                            <entry>
                                <para>network remains in 'allocated' if nic is added to it as first action</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-3408</para>
                            </entry>
                            <entry>
                                <para>userdata not available from all nics</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-3409</para>
                            </entry>
                            <entry>
                                <para>Security groups get clean up if VM is not in a running state</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-986</para>
                            </entry>
                            <entry>
                                <para>Add Ubuntu instructions to 'Using the Management Server As the NFS Server'</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-2338</para>
                            </entry>
                            <entry>
                                <para>Add example of how to sign an API request</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-2339</para>
                            </entry>
                            <entry>
                                <para>Add libcloud example</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-2859</para>
                            </entry>
                            <entry>
                                <para>configurations for secondary external DNS appear to be wrong (4.4.4.4)</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para>CLOUDSTACK-2902</para>
                            </entry>
                            <entry>
                                <para>baseurl incorrect in installation guide</para>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
        </section>
        <section id="known-issues-4.1.1">
            <title>Known Issues in 4.1.1</title>
            <informaltable>
                <tgroup cols="2" align="left" colsep="1" rowsep="1">
                    <colspec colwidth="1*" colname="1" colnum="1"/>
                    <colspec colwidth="2*" colname="2" colnum="2"/>
                    <thead>
                        <row>
                            <entry>
                                <para>Issue ID</para>
                            </entry>
                            <entry>
                                <para>Description</para>
                            </entry>
                        </row>
                    </thead>
                    <tbody>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-77">CLOUDSTACK-77</ulink></para>
                            </entry>
                            <entry>
                                <para>console proxy display issues</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-79">CLOUDSTACK-79</ulink></para>
                            </entry>
                            <entry>
                                <para>CloudStack 3.0.4: firewall rules not restored on KVM host</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-83">CLOUDSTACK-83</ulink></para>
                            </entry>
                            <entry>
                                <para>hitting exception when trying to take two consecutive snapshot on same volume</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-107">CLOUDSTACK-107</ulink></para>
                            </entry>
                            <entry>
                                <para>Network domain guest suffix is not getting programmed as part of hostnames on Guest VMs that are part of Isolated and Shared Guest Networks</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-124">CLOUDSTACK-124</ulink></para>
                            </entry>
                            <entry>
                                <para>NetworkGarbageCollector not cleaning up networks</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-155">CLOUDSTACK-155</ulink></para>
                            </entry>
                            <entry>
                                <para>HA checks lead to unnecessary Compute Node reboot when Primary Storage is in Maintenance Mode</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-216">CLOUDSTACK-216</ulink></para>
                            </entry>
                            <entry>
                                <para>Templates' Source Location Information present on "template_host_ref" and "vm_template" tables should refer to Apache System Template Locations</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-231">CLOUDSTACK-231</ulink></para>
                            </entry>
                            <entry>
                                <para>Tag creation using special charecters</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-237">CLOUDSTACK-237</ulink></para>
                            </entry>
                            <entry>
                                <para>StopVMCommand reported success in spite of failing to stop a VM which got stuck during installation from an ISO</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-238">CLOUDSTACK-238</ulink></para>
                            </entry>
                            <entry>
                                <para>vpn:fail to connect to vpnserver using non-sourceNAT IP</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-242">CLOUDSTACK-242</ulink></para>
                            </entry>
                            <entry>
                                <para>haproxy listens on all interfaces on VR</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-243">CLOUDSTACK-243</ulink></para>
                            </entry>
                            <entry>
                                <para>On management server, security for remote JMX connections is disabled</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-244">CLOUDSTACK-244</ulink></para>
                            </entry>
                            <entry>
                                <para>RPC port on SSVM is open on all interfaces</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-245">CLOUDSTACK-245</ulink></para>
                            </entry>
                            <entry>
                                <para>VPC ACLs are not stored and programmed consistently</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-252">CLOUDSTACK-252</ulink></para>
                            </entry>
                            <entry>
                                <para>UpdateNetwork Operation on a guest network that is currently using Virtual Router for Lb services to a network offering that uses "F5" for Lb services Fails due to MySQLIntegrityConstraintViolationException.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-255">CLOUDSTACK-255</ulink></para>
                            </entry>
                            <entry>
                                <para>Null pointer exception while creating portforwarding rule after performing UpdateNetworkCmd</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-270">CLOUDSTACK-270</ulink></para>
                            </entry>
                            <entry>
                                <para>Ui should not ask for a vlan range if the physical network isolation type is not VLAN</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-272">CLOUDSTACK-272</ulink></para>
                            </entry>
                            <entry>
                                <para>Delete failure message for network with a VM is not informative</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-280">CLOUDSTACK-280</ulink></para>
                            </entry>
                            <entry>
                                <para>Exception thrown on going to Step 5 of Add VM Instance - CloudRuntimeException: Tags are not defined for physical network in the zone id=1</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-282">CLOUDSTACK-282</ulink></para>
                            </entry>
                            <entry>
                                <para>Virtual Routers do not properly resolve DNS SRV Records</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-285">CLOUDSTACK-285</ulink></para>
                            </entry>
                            <entry>
                                <para>Snapshots fail to respect retention period if schedule is deleted and re-created.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-295">CLOUDSTACK-295</ulink></para>
                            </entry>
                            <entry>
                                <para>Add instructions to modify limits.conf in installation directions</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-298">CLOUDSTACK-298</ulink></para>
                            </entry>
                            <entry>
                                <para>putting host in maintenance mode while creating snapshot ,host resorce state stuck in "ErrorInMaintenance mode" and snapshot creation fail Unable to migrate due to Requested operation is not valid: cannot migrate domain with 1 snapshots</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-300">CLOUDSTACK-300</ulink></para>
                            </entry>
                            <entry>
                                <para>Creation of compute offering allow combination of local storage + HA</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-310">CLOUDSTACK-310</ulink></para>
                            </entry>
                            <entry>
                                <para>Failed to add host - Plugin error</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-315">CLOUDSTACK-315</ulink></para>
                            </entry>
                            <entry>
                                <para>Infrastructure view does not show capacity values</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-324">CLOUDSTACK-324</ulink></para>
                            </entry>
                            <entry>
                                <para>Cannot edit default security group rules, default security group blocks all inbound traffic.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-338">CLOUDSTACK-338</ulink></para>
                            </entry>
                            <entry>
                                <para>Unique Names of Disk and Service Offerings in the database are prefixed with "Cloud.com" String</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-360">CLOUDSTACK-360</ulink></para>
                            </entry>
                            <entry>
                                <para>System VM template isn't copied from Secondary Storage to XenServer's local SR</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-371">CLOUDSTACK-371</ulink></para>
                            </entry>
                            <entry>
                                <para>When naming physical networks in the zone wizard, special characters like () break the wizard</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-375">CLOUDSTACK-375</ulink></para>
                            </entry>
                            <entry>
                                <para>Unable to delete physical network - because there are other networks attached</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-381">CLOUDSTACK-381</ulink></para>
                            </entry>
                            <entry>
                                <para>Install Guide: Section 2.5: Notes that you can skip secondary storage if you are using local disks.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-382">CLOUDSTACK-382</ulink></para>
                            </entry>
                            <entry>
                                <para>Install Guide: Network Type Descriptions</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-410">CLOUDSTACK-410</ulink></para>
                            </entry>
                            <entry>
                                <para>vnc_listen not configured in qemu.conf for Ubuntu KVM host</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-425">CLOUDSTACK-425</ulink></para>
                            </entry>
                            <entry>
                                <para>Check image type is qcow2 before actually installing</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-429">CLOUDSTACK-429</ulink></para>
                            </entry>
                            <entry>
                                <para>Agent rebalancing is broken</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-433">CLOUDSTACK-433</ulink></para>
                            </entry>
                            <entry>
                                <para>IP addresses can be left assigned and orphaned when static NAT assign fails</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-440">CLOUDSTACK-440</ulink></para>
                            </entry>
                            <entry>
                                <para>create networks in advanced zone with out VLAN isolation</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-458">CLOUDSTACK-458</ulink></para>
                            </entry>
                            <entry>
                                <para>xen:snapshots:Storage gc fail to clean the failed snapshot images from secondarystorage</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-463">CLOUDSTACK-463</ulink></para>
                            </entry>
                            <entry>
                                <para>mvn does not inject agent version into .JAR files.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-468">CLOUDSTACK-468</ulink></para>
                            </entry>
                            <entry>
                                <para>Difficult to find API reference when there is no link to it from the Documentation landing page</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-469">CLOUDSTACK-469</ulink></para>
                            </entry>
                            <entry>
                                <para>CloudStack Documentation Landing Page has Alignment Issues</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-470">CLOUDSTACK-470</ulink></para>
                            </entry>
                            <entry>
                                <para>Add vm does not list all vms when creating port forwards</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-482">CLOUDSTACK-482</ulink></para>
                            </entry>
                            <entry>
                                <para>Installation Guide Doc Error Section 4.5.7</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-486">CLOUDSTACK-486</ulink></para>
                            </entry>
                            <entry>
                                <para>Clicking UI notifications for System VM or Virtual Router opens Instances page</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-489">CLOUDSTACK-489</ulink></para>
                            </entry>
                            <entry>
                                <para>Document how to use userdata feature for user vms</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-506">CLOUDSTACK-506</ulink></para>
                            </entry>
                            <entry>
                                <para>[UI] Unable to execute API command liststoragepools</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-519">CLOUDSTACK-519</ulink></para>
                            </entry>
                            <entry>
                                <para>Cloudstack development environment on Windows using Cygwin references 'sudo' which is not available in Cygwin</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-525">CLOUDSTACK-525</ulink></para>
                            </entry>
                            <entry>
                                <para>Cloudstack Redundant Virtual Router issues both MASTER.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-526">CLOUDSTACK-526</ulink></para>
                            </entry>
                            <entry>
                                <para>Cloudstack Redundant Virtual Router issues with Port Forwarding</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-532">CLOUDSTACK-532</ulink></para>
                            </entry>
                            <entry>
                                <para>Storage-template-cleanup corrupts templates</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-535">CLOUDSTACK-535</ulink></para>
                            </entry>
                            <entry>
                                <para>Virtual Router DNS is restricted to UDP only</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-554">CLOUDSTACK-554</ulink></para>
                            </entry>
                            <entry>
                                <para>Cloudstack should virtualized 32bits CPUs for 32bits templates</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-561">CLOUDSTACK-561</ulink></para>
                            </entry>
                            <entry>
                                <para>createNetwork can block for long periods causing clients to time out when called at certain times</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-562">CLOUDSTACK-562</ulink></para>
                            </entry>
                            <entry>
                                <para>Unable to download DATA volume on CS4 and vSphere 5</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-563">CLOUDSTACK-563</ulink></para>
                            </entry>
                            <entry>
                                <para>Unable to create guest network in UI for Advanced Zone</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-568">CLOUDSTACK-568</ulink></para>
                            </entry>
                            <entry>
                                <para>Source template id is recorded incorrectly.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-575">CLOUDSTACK-575</ulink></para>
                            </entry>
                            <entry>
                                <para>Cannot change memory size of the console.ram.size, ssvm.ram.size using web console</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-582">CLOUDSTACK-582</ulink></para>
                            </entry>
                            <entry>
                                <para>Cannot perform password reset for Windows instances on VMWare</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-586">CLOUDSTACK-586</ulink></para>
                            </entry>
                            <entry>
                                <para>exportfs -a gives 'no_subtree_check warning' when following the Installation guide</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-589">CLOUDSTACK-589</ulink></para>
                            </entry>
                            <entry>
                                <para>Juniper SRX does not depend on f5 iControl jar</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-597">CLOUDSTACK-597</ulink></para>
                            </entry>
                            <entry>
                                <para>Management Server Restart loses hosts</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-626">CLOUDSTACK-626</ulink></para>
                            </entry>
                            <entry>
                                <para>guest_os table does not have latest distro</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-649">CLOUDSTACK-649</ulink></para>
                            </entry>
                            <entry>
                                <para>KVM storage gc does not delete the invalid snapshots from physical storage</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-668">CLOUDSTACK-668</ulink></para>
                            </entry>
                            <entry>
                                <para>Secondary storage host always remains in Alert status</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-688">CLOUDSTACK-688</ulink></para>
                            </entry>
                            <entry>
                                <para>UI Russian language</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-696">CLOUDSTACK-696</ulink></para>
                            </entry>
                            <entry>
                                <para>Networks with same name and VLAN are allowed in the same Zone</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-722">CLOUDSTACK-722</ulink></para>
                            </entry>
                            <entry>
                                <para>Using a certificate chain for the Console Proxy is not documented</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-732">CLOUDSTACK-732</ulink></para>
                            </entry>
                            <entry>
                                <para>Add back KVM snapshot support</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-904">CLOUDSTACK-904</ulink></para>
                            </entry>
                            <entry>
                                <para>CloudStack export the CPU as a socket not core</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-969">CLOUDSTACK-969</ulink></para>
                            </entry>
                            <entry>
                                <para>api: zone response lists vlan in it as "vlan range of zone" but the vlan belongs to physical network</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-970">CLOUDSTACK-970</ulink></para>
                            </entry>
                            <entry>
                                <para>when a template is deleted and then copied over again , it is still marked as "Removed" in template_zone_ref table.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-989">CLOUDSTACK-989</ulink></para>
                            </entry>
                            <entry>
                                <para>marvin: jsonHelper deserialization results in unfilled attributes</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-992">CLOUDSTACK-992</ulink></para>
                            </entry>
                            <entry>
                                <para>Template creations dies after 2h for no reason</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-994">CLOUDSTACK-994</ulink></para>
                            </entry>
                            <entry>
                                <para>Feature Request: Support VmWare Storage Pool</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1007">CLOUDSTACK-1007</ulink></para>
                            </entry>
                            <entry>
                                <para>Not able to delete Shared network because of not being able to stop the router.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1018">CLOUDSTACK-1018</ulink></para>
                            </entry>
                            <entry>
                                <para>IPtables manipulation is EL-specific and doesn't cover Ubuntu</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1025">CLOUDSTACK-1025</ulink></para>
                            </entry>
                            <entry>
                                <para>If an ISO is deleted there is no check if the ISO is actually attached to a guest or not.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1048">CLOUDSTACK-1048</ulink></para>
                            </entry>
                            <entry>
                                <para>Launching AutoScale: Documentation Flow is Incorrect</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1053">CLOUDSTACK-1053</ulink></para>
                            </entry>
                            <entry>
                                <para>Start systemvm</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1069">CLOUDSTACK-1069</ulink></para>
                            </entry>
                            <entry>
                                <para>Document workaround for: CS and LDAP user validation can't happen simultaneously</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1075">CLOUDSTACK-1075</ulink></para>
                            </entry>
                            <entry>
                                <para>create an utility in Marvin to support nsnitro</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1089">CLOUDSTACK-1089</ulink></para>
                            </entry>
                            <entry>
                                <para>API Problem with listAsyncJobs</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1090">CLOUDSTACK-1090</ulink></para>
                            </entry>
                            <entry>
                                <para>VM unable to obtain guest IP from a virtual router running on another XCP/XenServer hypervisor (Cloudstack Advanced Zone Setup)</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1167">CLOUDSTACK-1167</ulink></para>
                            </entry>
                            <entry>
                                <para>arptables rules are not destroyed after vm is stopped in XenServer in basic zone</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1177">CLOUDSTACK-1177</ulink></para>
                            </entry>
                            <entry>
                                <para>CloudStack always reports 'invalid username or password' when using IE10</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1194">CLOUDSTACK-1194</ulink></para>
                            </entry>
                            <entry>
                                <para>Bug with the web interface (re isolation method)</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1195">CLOUDSTACK-1195</ulink></para>
                            </entry>
                            <entry>
                                <para>Wrong isolation method offered for KVM hypervisor</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1197">CLOUDSTACK-1197</ulink></para>
                            </entry>
                            <entry>
                                <para>Basic zone DNS domain not offered by VR</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1199">CLOUDSTACK-1199</ulink></para>
                            </entry>
                            <entry>
                                <para>External DNS not being added to reslov.conf</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1225">CLOUDSTACK-1225</ulink></para>
                            </entry>
                            <entry>
                                <para>Storage System vm id keeps on increasing</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1236">CLOUDSTACK-1236</ulink></para>
                            </entry>
                            <entry>
                                <para>Warning while adding Xen 6.1 host [Unable to create local link network]</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1245">CLOUDSTACK-1245</ulink></para>
                            </entry>
                            <entry>
                                <para>Not able to install Debian based PV Instances from ISO,only HVM instances is possible.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1249">CLOUDSTACK-1249</ulink></para>
                            </entry>
                            <entry>
                                <para>CloudStack Service restart has inconsistent names</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1259">CLOUDSTACK-1259</ulink></para>
                            </entry>
                            <entry>
                                <para>NPE at service shutdown</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1282">CLOUDSTACK-1282</ulink></para>
                            </entry>
                            <entry>
                                <para>UI - Tooltip - Missing tooltip for Projects page</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1283">CLOUDSTACK-1283</ulink></para>
                            </entry>
                            <entry>
                                <para>UI - Tooltip - Need a clean way to differentiate between Alt Tag's and Tooltips.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1284">CLOUDSTACK-1284</ulink></para>
                            </entry>
                            <entry>
                                <para>UI - Tooltip - Inconsistent tool tip rendering among installation wizards</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1285">CLOUDSTACK-1285</ulink></para>
                            </entry>
                            <entry>
                                <para>UI -Tooltip - Lengthy and inconsistent description among toolips</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1302">CLOUDSTACK-1302</ulink></para>
                            </entry>
                            <entry>
                                <para>Add per storage setting for cache="none/writeback/writethrough" options for VMs on KVM hypervisor</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1304">CLOUDSTACK-1304</ulink></para>
                            </entry>
                            <entry>
                                <para>"mvn -pl :cloud-client-ui jetty:run" strips permission of files in script/</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1306">CLOUDSTACK-1306</ulink></para>
                            </entry>
                            <entry>
                                <para>Better Error message when trying to deploy Vm by passing static Ipv4 addresses that are assigned to another VM/IP4 address is outside the iprange.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1309">CLOUDSTACK-1309</ulink></para>
                            </entry>
                            <entry>
                                <para>Large guest subnets downgrade performance</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1316">CLOUDSTACK-1316</ulink></para>
                            </entry>
                            <entry>
                                <para>Documentation update for "cloud-set-guest-password" needed</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1327">CLOUDSTACK-1327</ulink></para>
                            </entry>
                            <entry>
                                <para>Cloudstack allows users to import huge templates from unauthorised URLs</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1358">CLOUDSTACK-1358</ulink></para>
                            </entry>
                            <entry>
                                <para>Clarify format of url field of the createStoragePool API command</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1359">CLOUDSTACK-1359</ulink></para>
                            </entry>
                            <entry>
                                <para>Clarify what we mean by GB in CloudStack documentation</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1389">CLOUDSTACK-1389</ulink></para>
                            </entry>
                            <entry>
                                <para>Interactive Password Prompts during Management Server Startup</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1393">CLOUDSTACK-1393</ulink></para>
                            </entry>
                            <entry>
                                <para>Install scripts shows wrong path to copy vhd-util</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1408">CLOUDSTACK-1408</ulink></para>
                            </entry>
                            <entry>
                                <para>Error creating new instance with sufficient resources!</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1412">CLOUDSTACK-1412</ulink></para>
                            </entry>
                            <entry>
                                <para>listUsageRecords will loop data if requested page is beyond what is available</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1413">CLOUDSTACK-1413</ulink></para>
                            </entry>
                            <entry>
                                <para>Need something to concretely identify the version of the code in a particular build</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1424">CLOUDSTACK-1424</ulink></para>
                            </entry>
                            <entry>
                                <para>Failed with NPE while deleting account when there are snapshots created for this account instances</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1432">CLOUDSTACK-1432</ulink></para>
                            </entry>
                            <entry>
                                <para>Inconsistent field names in "Add Cluster" dialog</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1458">CLOUDSTACK-1458</ulink></para>
                            </entry>
                            <entry>
                                <para>Add Zone wizard UI gets visually broken if additional browser toolbars are used.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1460">CLOUDSTACK-1460</ulink></para>
                            </entry>
                            <entry>
                                <para>UI : List Storage table has unused column name Actions</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1492">CLOUDSTACK-1492</ulink></para>
                            </entry>
                            <entry>
                                <para>Missing Guide: Allocator Implementation Guide</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1497">CLOUDSTACK-1497</ulink></para>
                            </entry>
                            <entry>
                                <para>Alien VM's are deleted on migration by xenserver.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1500">CLOUDSTACK-1500</ulink></para>
                            </entry>
                            <entry>
                                <para>Unable to connect to instances via View console</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1504">CLOUDSTACK-1504</ulink></para>
                            </entry>
                            <entry>
                                <para>VMWare is not using the VLAN tag for storage port-group</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1605">CLOUDSTACK-1605</ulink></para>
                            </entry>
                            <entry>
                                <para>No Documentation on Network Throttling</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1632">CLOUDSTACK-1632</ulink></para>
                            </entry>
                            <entry>
                                <para>Mistakes in authorizeSecurityGroup* API docs</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1654">CLOUDSTACK-1654</ulink></para>
                            </entry>
                            <entry>
                                <para>Management and Host installed on same machine, Management cannot get ID.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1660">CLOUDSTACK-1660</ulink></para>
                            </entry>
                            <entry>
                                <para>CloudStack 4.1 RPM install Warning</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1702">CLOUDSTACK-1702</ulink></para>
                            </entry>
                            <entry>
                                <para>Error messages returning numeric ID's in some places instead of UUIDs</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1703">CLOUDSTACK-1703</ulink></para>
                            </entry>
                            <entry>
                                <para>Management Server access error: "Error while decrypting..."</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1712">CLOUDSTACK-1712</ulink></para>
                            </entry>
                            <entry>
                                <para>Documentation for Creating a Template doesn't match what's presented in management server</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1717">CLOUDSTACK-1717</ulink></para>
                            </entry>
                            <entry>
                                <para>AWS Regions - Local region entry that gets added by default should not include "/api" for its end_point.Also the endpoint should have the actual hostname instead of localhost.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1743">CLOUDSTACK-1743</ulink></para>
                            </entry>
                            <entry>
                                <para>No Section on About Password and Key Encryption Though Multiple References Appear in the Install Guide</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1775">CLOUDSTACK-1775</ulink></para>
                            </entry>
                            <entry>
                                <para>Events related User/Domain/Account are not being generated expect for USER-DISABLE,DOMAIN-DELETE and ACCOUNT.DISABLE event.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1780">CLOUDSTACK-1780</ulink></para>
                            </entry>
                            <entry>
                                <para>Client UI: i18N files (messages_xx_XX.properties) needs to be convert in ASCII with unicode char \uxxxx (and perhaps keys needs to be in alphabetical order)</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1783">CLOUDSTACK-1783</ulink></para>
                            </entry>
                            <entry>
                                <para>Alteration of some messages i18n files (ja, zh_CN ...) since last commit with transifex export files</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1790">CLOUDSTACK-1790</ulink></para>
                            </entry>
                            <entry>
                                <para>Lock down ports for all system VMs</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1801">CLOUDSTACK-1801</ulink></para>
                            </entry>
                            <entry>
                                <para>Upgrade from 3.0.2 to 4.0.1 Fails</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1807">CLOUDSTACK-1807</ulink></para>
                            </entry>
                            <entry>
                                <para>CS4 AWS S3 support - List all buckets AWS API doesnot return correct response if not buckets are created on NFS mount</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1819">CLOUDSTACK-1819</ulink></para>
                            </entry>
                            <entry>
                                <para>AWS Regions - Issues seen when trying to move a zone from 1 region to another.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1821">CLOUDSTACK-1821</ulink></para>
                            </entry>
                            <entry>
                                <para>AWS S3 API -Get bucket by name - ACLs do not give user the required permission</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1835">CLOUDSTACK-1835</ulink></para>
                            </entry>
                            <entry>
                                <para>VMWare tries to use vSwitch0 when it shouldn't</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1868">CLOUDSTACK-1868</ulink></para>
                            </entry>
                            <entry>
                                <para>GetVmStatsCommand throws NullPointerException with VMWare</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1872">CLOUDSTACK-1872</ulink></para>
                            </entry>
                            <entry>
                                <para>Do not accept OVAs with multiple VMDKs for uploaded volumes or templates</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1885">CLOUDSTACK-1885</ulink></para>
                            </entry>
                            <entry>
                                <para>Broken testcases in 4.1</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1896">CLOUDSTACK-1896</ulink></para>
                            </entry>
                            <entry>
                                <para>S3-backed NFS secondary storage uses Db-based lock when DB is not available</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1899">CLOUDSTACK-1899</ulink></para>
                            </entry>
                            <entry>
                                <para>SRX firewall external devices - static NAT does not function</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1932">CLOUDSTACK-1932</ulink></para>
                            </entry>
                            <entry>
                                <para>AutoScale UI documentation doesn't mention the option appears only for NetScaler</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1965">CLOUDSTACK-1965</ulink></para>
                            </entry>
                            <entry>
                                <para>15.8. External Firewalls and Load Balancers Section is Incomplete</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1967">CLOUDSTACK-1967</ulink></para>
                            </entry>
                            <entry>
                                <para>Maintenance mode not fully working with VMWare</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1969">CLOUDSTACK-1969</ulink></para>
                            </entry>
                            <entry>
                                <para>Ubuntu fresh Install- SystemIntegrityChecker looking for "schema-40to410.sql" wrong location and failed to start MS</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1970">CLOUDSTACK-1970</ulink></para>
                            </entry>
                            <entry>
                                <para>Ubuntu - "cloudstack-setup-management" not available in "/usr/bin"</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1986">CLOUDSTACK-1986</ulink></para>
                            </entry>
                            <entry>
                                <para>Key translation fails for the Japanese keyboard keys ¥_,\ |, Muhenkan, Henkan, Hiragana/Katakana, Kanji Key and Caps Loc</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1992">CLOUDSTACK-1992</ulink></para>
                            </entry>
                            <entry>
                                <para>Cannot deploy VM from template on VMWare, no issues when deploying from ISO</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-1996">CLOUDSTACK-1996</ulink></para>
                            </entry>
                            <entry>
                                <para>Storage tags ignored when using VMWare</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2015">CLOUDSTACK-2015</ulink></para>
                            </entry>
                            <entry>
                                <para>CS3.0.2 VR is pending in starting state，when VR is recreated.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2018">CLOUDSTACK-2018</ulink></para>
                            </entry>
                            <entry>
                                <para>[DOC] How system.vm passwords can be randomized</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2024">CLOUDSTACK-2024</ulink></para>
                            </entry>
                            <entry>
                                <para>cloudstack-setup-management with https not works (incorrect path and missing keystore file)</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2025">CLOUDSTACK-2025</ulink></para>
                            </entry>
                            <entry>
                                <para>Failed VM creation on Xen Server does not release shared IP address</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2047">CLOUDSTACK-2047</ulink></para>
                            </entry>
                            <entry>
                                <para>Cloudstack Management Server host key is set to localhost</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2050">CLOUDSTACK-2050</ulink></para>
                            </entry>
                            <entry>
                                <para>encode.api.response in global settings when set to true will create garbled % output int he gui and json output</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2053">CLOUDSTACK-2053</ulink></para>
                            </entry>
                            <entry>
                                <para>[BUG] userdata.sh on router VM fixes for if else logic and missing meta-data</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2072">CLOUDSTACK-2072</ulink></para>
                            </entry>
                            <entry>
                                <para>Virtual Routers Failover not working</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2075">CLOUDSTACK-2075</ulink></para>
                            </entry>
                            <entry>
                                <para>List capacity error causes UI to display status overlay</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2183">CLOUDSTACK-2183</ulink></para>
                            </entry>
                            <entry>
                                <para>Database upgrade from 3.0.2 to 4.0.1 failed</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2203">CLOUDSTACK-2203</ulink></para>
                            </entry>
                            <entry>
                                <para>SSVM does not redeploy after destroyed</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2213">CLOUDSTACK-2213</ulink></para>
                            </entry>
                            <entry>
                                <para>russian language select failure</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2215">CLOUDSTACK-2215</ulink></para>
                            </entry>
                            <entry>
                                <para>SSVM does not use allocated storage ip range</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2216">CLOUDSTACK-2216</ulink></para>
                            </entry>
                            <entry>
                                <para>CloudStack Manager sends wrong validBackupUUIDs to Secondary Storage VM when clean up snapshot backup. This causes the snapshots backup not garbage collected correctly and gets the secondary storage filled up.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2217">CLOUDSTACK-2217</ulink></para>
                            </entry>
                            <entry>
                                <para>Snapshots backups are not deleted according to CleanupSnapshotBackupCommand. Those snapshots backups that should be garbage collected but not get deleted can fill up the secondary storage.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2224">CLOUDSTACK-2224</ulink></para>
                            </entry>
                            <entry>
                                <para>"filterwin2k" should not be set in dnsmasq.conf</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2299">CLOUDSTACK-2299</ulink></para>
                            </entry>
                            <entry>
                                <para>Stale DHCP leases block IP reallocation</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2300">CLOUDSTACK-2300</ulink></para>
                            </entry>
                            <entry>
                                <para>Unexpected deletion of Snapshots backups</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2325">CLOUDSTACK-2325</ulink></para>
                            </entry>
                            <entry>
                                <para>incomplete sentence in installation guide</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2344">CLOUDSTACK-2344</ulink></para>
                            </entry>
                            <entry>
                                <para>not enough free memory on one host of the cluster</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2353">CLOUDSTACK-2353</ulink></para>
                            </entry>
                            <entry>
                                <para>Figure out how spring can allow for inheritable component contexts</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2383">CLOUDSTACK-2383</ulink></para>
                            </entry>
                            <entry>
                                <para>"Entity already exists" error at automatic virtual router VM creation.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2388">CLOUDSTACK-2388</ulink></para>
                            </entry>
                            <entry>
                                <para>HA "Host Allocator returning 0 suitable hosts" but starting the VM manually finds one.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2446">CLOUDSTACK-2446</ulink></para>
                            </entry>
                            <entry>
                                <para>System Capacity Zone total memory calculation is wrong</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2448">CLOUDSTACK-2448</ulink></para>
                            </entry>
                            <entry>
                                <para>XenServer Guest OS Corrections</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2455">CLOUDSTACK-2455</ulink></para>
                            </entry>
                            <entry>
                                <para>Cannot add a Debian host to a KVM cluster</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2530">CLOUDSTACK-2530</ulink></para>
                            </entry>
                            <entry>
                                <para>fix npe if no network isolation methods</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2532">CLOUDSTACK-2532</ulink></para>
                            </entry>
                            <entry>
                                <para>remove bogus self assign to parent</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2535">CLOUDSTACK-2535</ulink></para>
                            </entry>
                            <entry>
                                <para>Cleanup port-profiles that gets created on Nexus switch as part of network cleanup</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2574">CLOUDSTACK-2574</ulink></para>
                            </entry>
                            <entry>
                                <para>Release note pdf link</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2608">CLOUDSTACK-2608</ulink></para>
                            </entry>
                            <entry>
                                <para>Vmware network labels are ignored when creating a Zone using advance networking</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2610">CLOUDSTACK-2610</ulink></para>
                            </entry>
                            <entry>
                                <para>Unable to add host due to missing setiptables plugin</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2616">CLOUDSTACK-2616</ulink></para>
                            </entry>
                            <entry>
                                <para>com.mysql.jdbc.exceptions.jdbc4.CommunicationsException error is displayed in management server log after long time of inactive mysql connection</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2654">CLOUDSTACK-2654</ulink></para>
                            </entry>
                            <entry>
                                <para>VPC UI Missing information</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2692">CLOUDSTACK-2692</ulink></para>
                            </entry>
                            <entry>
                                <para>[MIPN][Enhancement] Add load balancing support for MIPN</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2694">CLOUDSTACK-2694</ulink></para>
                            </entry>
                            <entry>
                                <para>[Firewall Rule] Able to configure duplicate firewall rule with protocol and no ports</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2702">CLOUDSTACK-2702</ulink></para>
                            </entry>
                            <entry>
                                <para>unable to install XenServer Support Package (CSP) on Xen cloud platform 1.6</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2721">CLOUDSTACK-2721</ulink></para>
                            </entry>
                            <entry>
                                <para>Marvin cloudstackConnection fails if no port is specified</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2722">CLOUDSTACK-2722</ulink></para>
                            </entry>
                            <entry>
                                <para>KVM Hypervisor host install instructions say to set up VLANs for Basic networking</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2780">CLOUDSTACK-2780</ulink></para>
                            </entry>
                            <entry>
                                <para>primary storage is already mounted but not found in pool-list</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2791">CLOUDSTACK-2791</ulink></para>
                            </entry>
                            <entry>
                                <para>Installation instruction wrong</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2795">CLOUDSTACK-2795</ulink></para>
                            </entry>
                            <entry>
                                <para>Create template failed</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2804">CLOUDSTACK-2804</ulink></para>
                            </entry>
                            <entry>
                                <para>getEthByIp function in vpc_func.sh can return the wrong network interface</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2845">CLOUDSTACK-2845</ulink></para>
                            </entry>
                            <entry>
                                <para>Duplicate entries in the database since upgrade to 4.1.0</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2860">CLOUDSTACK-2860</ulink></para>
                            </entry>
                            <entry>
                                <para>Add new host into VMWare Cluster failed</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2872">CLOUDSTACK-2872</ulink></para>
                            </entry>
                            <entry>
                                <para>ubuntu 12.4 kvm issue CS 4.1 libvirt complaint and not able to start systemvm</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2895">CLOUDSTACK-2895</ulink></para>
                            </entry>
                            <entry>
                                <para>Can't start a VM with 3 volumes attached [VMWare]</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2896">CLOUDSTACK-2896</ulink></para>
                            </entry>
                            <entry>
                                <para>pt-BR docs without index.html</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2897">CLOUDSTACK-2897</ulink></para>
                            </entry>
                            <entry>
                                <para>Storage migration has left volumes on secondary storage</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2907">CLOUDSTACK-2907</ulink></para>
                            </entry>
                            <entry>
                                <para>In the case of a VMware HyperVisor,Sample Template (CentOS 5.3(64-bit) no GUI (vSphere)) download does not start.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2908">CLOUDSTACK-2908</ulink></para>
                            </entry>
                            <entry>
                                <para>An automatic start setup is not carried out after cloudstack-usage installation.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2913">CLOUDSTACK-2913</ulink></para>
                            </entry>
                            <entry>
                                <para>Spurious error message during install at the end of the RPM build process.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2926">CLOUDSTACK-2926</ulink></para>
                            </entry>
                            <entry>
                                <para>An virtual machine instance cannot be started in a mixed hypervisor environment.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2929">CLOUDSTACK-2929</ulink></para>
                            </entry>
                            <entry>
                                <para>unable to upgrade from version 3.0.6.20121222035904</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-2996">CLOUDSTACK-2996</ulink></para>
                            </entry>
                            <entry>
                                <para>Nullpointer exception on view console on vmware</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3008">CLOUDSTACK-3008</ulink></para>
                            </entry>
                            <entry>
                                <para>Section 4.5.3.2 of the 4.1.0 documentation is incorrect cloud-client does not seem to exist</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3048">CLOUDSTACK-3048</ulink></para>
                            </entry>
                            <entry>
                                <para>Memory not reported correctly</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3061">CLOUDSTACK-3061</ulink></para>
                            </entry>
                            <entry>
                                <para>listHosts API doesn't has cpuused</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3098">CLOUDSTACK-3098</ulink></para>
                            </entry>
                            <entry>
                                <para>Location to copy vhd-util is wrong in docs</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3138">CLOUDSTACK-3138</ulink></para>
                            </entry>
                            <entry>
                                <para>Flaws in upgrade documentation from 3.0.2 -&gt; 4.1.0</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3143">CLOUDSTACK-3143</ulink></para>
                            </entry>
                            <entry>
                                <para>revoke securitygroup ingress/egress does not return correct response</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3163">CLOUDSTACK-3163</ulink></para>
                            </entry>
                            <entry>
                                <para>KVM Virtual Router startup time is painfully long</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3195">CLOUDSTACK-3195</ulink></para>
                            </entry>
                            <entry>
                                <para>cannot view/delete forward rules if underlying/target VM is destroyed first</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3216">CLOUDSTACK-3216</ulink></para>
                            </entry>
                            <entry>
                                <para>Logs in the Software router are not being rotated</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3243">CLOUDSTACK-3243</ulink></para>
                            </entry>
                            <entry>
                                <para>Wrong NFS mount point in documentation</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3272">CLOUDSTACK-3272</ulink></para>
                            </entry>
                            <entry>
                                <para>EventBus: add global config parameters to specify which category of events are published on event bus.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3330">CLOUDSTACK-3330</ulink></para>
                            </entry>
                            <entry>
                                <para>Autoscaling needs a VR to work</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3350">CLOUDSTACK-3350</ulink></para>
                            </entry>
                            <entry>
                                <para>Snapshots not deleted from swift</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3366">CLOUDSTACK-3366</ulink></para>
                            </entry>
                            <entry>
                                <para>Autoscaling won't scale down</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3367">CLOUDSTACK-3367</ulink></para>
                            </entry>
                            <entry>
                                <para>When one primary storage fails, all XenServer hosts get rebooted, killing all VMs, even those not on this primary storage.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3369">CLOUDSTACK-3369</ulink></para>
                            </entry>
                            <entry>
                                <para>Autoscaling: Deleting an isolated network of an account deletes also the autoscaling rule for a network associated with another account</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3381">CLOUDSTACK-3381</ulink></para>
                            </entry>
                            <entry>
                                <para>Wrong instruction in CloudStack release notes</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3383">CLOUDSTACK-3383</ulink></para>
                            </entry>
                            <entry>
                                <para>GetHostStatsCommand fails when agent is running Ubuntu 13.04 (raring)</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3401">CLOUDSTACK-3401</ulink></para>
                            </entry>
                            <entry>
                                <para>Small page sizes return duplicate results</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3421">CLOUDSTACK-3421</ulink></para>
                            </entry>
                            <entry>
                                <para>When hypervisor is down, no HA occurs with log output "Agent state cannot be determined, do nothing"</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3471">CLOUDSTACK-3471</ulink></para>
                            </entry>
                            <entry>
                                <para>Provide an API to extract the log statements of a given jobid</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3503">CLOUDSTACK-3503</ulink></para>
                            </entry>
                            <entry>
                                <para>KVM Agent writes to agent.properties</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3535">CLOUDSTACK-3535</ulink></para>
                            </entry>
                            <entry>
                                <para>No HA actions are performed when a KVM host goes offline</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3542">CLOUDSTACK-3542</ulink></para>
                            </entry>
                            <entry>
                                <para>Ceph RBD provides wrong usage info to CloudStack</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3543">CLOUDSTACK-3543</ulink></para>
                            </entry>
                            <entry>
                                <para>the cpvm and ssvm' state is still running when the computer node was crashed</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3546">CLOUDSTACK-3546</ulink></para>
                            </entry>
                            <entry>
                                <para>[DOC] Update 4.2 Developer Guide</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3556">CLOUDSTACK-3556</ulink></para>
                            </entry>
                            <entry>
                                <para>Add NIC icon is not appearing in UI</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3578">CLOUDSTACK-3578</ulink></para>
                            </entry>
                            <entry>
                                <para>Unable to add Physical Dom0 as host, to cloudstack domU.</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3593">CLOUDSTACK-3593</ulink></para>
                            </entry>
                            <entry>
                                <para>Wrong Resource capacity for primary storage (Double the amount)</para>
                            </entry>
                        </row>
                        <row>
                            <entry>
                                <para><ulink url="https://issues.apache.org/jira/browse/CLOUDSTACK-3625">CLOUDSTACK-3625</ulink></para>
                            </entry>
                            <entry>
                                <para>Non CloudStack VM's = Alien VM's are deleted</para>
                            </entry>
                        </row>
                    </tbody>
                </tgroup>
            </informaltable>
        </section>
    </chapter>
    <chapter id="upgrade-instructions">
        <title>Upgrade Instructions</title>
        <para>This section contains upgrade instructions from prior versions of CloudStack to &PRODUCT; 4.1.1. We include instructions on upgrading to &PRODUCT; from pre-Apache versions of Citrix CloudStack (last version prior to Apache is 3.0.2) and from the releases made while CloudStack was in the Apache Incubator.</para>
        <para>If you run into any issues during upgrades, please feel free to ask questions on users@cloudstack.apache.org or dev@cloudstack.apache.org.</para>
        <section id="upgrade-from-4.1.0-to-4.1.1">
            <title>Upgrade from 4.1.0 to 4.1.1</title>
            <para>This section will guide you from &PRODUCT; 4.1.0 versions to &PRODUCT; 4.1.1.</para>
            <para>Any steps that are hypervisor-specific will be called out with a note.</para>
            <para>We recommend reading through this section once or twice before beginning your upgrade procedure, and working through it on a test system before working on a production system.</para>
            <orderedlist>
                <listitem>
                    <para>Most users of &PRODUCT; manage the installation and upgrades of &PRODUCT; with one of Linux's predominant package systems, RPM or APT. This guide assumes you'll be using RPM and Yum (for Red Hat Enterprise Linux or CentOS), or APT and Debian packages (for Ubuntu).</para>
                    <para>Create RPM or Debian packages (as appropriate) and a repository from the 4.1.1 source, or check the &PRODUCT; downloads page at <ulink url="http://cloudstack.apache.org/downloads.html">http://cloudstack.apache.org/downloads.html</ulink> for package repositories supplied by community members. You will need them for step <xref linkend="upgrade-deb-packages-411" /> or step <xref linkend="upgrade-rpm-packages-411" />.</para>
                    <para>Instructions for creating packages from the &PRODUCT; source are in the <ulink url="http://cloudstack.apache.org/docs/en-US/index.html">Installation Guide</ulink>.</para>
                </listitem>
                <listitem>
                    <para>Stop your management server or servers. Run this on all management server hosts:</para>
                    <programlisting><prompt>#</prompt> service cloudstack-management stop</programlisting>
                </listitem>
                <listitem>
                    <para>If you are running a usage server or usage servers, stop those as well:</para>
                    <programlisting><prompt>#</prompt> service cloudstack-usage stop</programlisting>
                </listitem>
                <listitem>
                    <para>Make a backup of your MySQL database. If you run into any issues or need to roll back the upgrade, this will assist in debugging or restoring your existing environment. You'll be prompted for your password.</para>
                    <programlisting><prompt>#</prompt> mysqldump -u root -p cloud &gt; cloudstack-backup.sql</programlisting>
                </listitem>
                <listitem id="upgrade-deb-packages-411">
                    <para>If you are using Ubuntu, follow this procedure to upgrade your packages. If not, skip to step <xref linkend="upgrade-rpm-packages-411" />.</para> 
                    <note><title>Community Packages</title>
                        <para>This section assumes you're using the community supplied packages for &PRODUCT;. If you've created your own packages and APT repository, substitute your own URL for the ones used in these examples.</para>
                    </note>
                    <orderedlist id="debsteps-411">
                        <listitem>
                            <para>The first step is to confirm that your sources list is pointed to the correct repository for each system with &PRODUCT; packages. This means all management servers, and any hosts that have the KVM agent. (No changes should be necessary for hosts that are running VMware or Xen.)</para>
                            <para>Start by opening <filename>/etc/apt/sources.list.d/cloudstack.list</filename> on any systems that have &PRODUCT; packages installed.</para>
                            <para>This file should have one line, which contains:</para>
                            <programlisting language="Bash">deb http://cloudstack.apt-get.eu/ubuntu precise 4.1</programlisting>
                            <para>If the line above is not correct, correct it. Note that if you're using your own package repository, change this line to read as appropriate for your 4.1.1 repository.</para>
                        </listitem>
                        <listitem>
                            <para>Now update your apt package list:</para>
                            <programlisting language="Bash">$ sudo apt-get update</programlisting>
                        </listitem>
                        <listitem id="deb-master-411">
                            <para>Now that you have the repository configured, it's time to update the <filename>cloudstack-management</filename> package. This will pull in any other dependencies and updates you need.</para>
                            <programlisting language="Bash">$ sudo apt-get install cloudstack-management</programlisting>
                        </listitem>
                        <listitem id="kvm-agent-deb-411">
                            <para>On KVM hosts you will need to also upgrade the <filename>cloudstack-agent</filename> package:</para>
                            <programlisting language="Bash">$ sudo apt-get install cloudstack-agent</programlisting>
                        </listitem>
                        <listitem>
                            <para>Verify that the file <filename>/etc/cloudstack/agent/environment.properties</filename> has a line that reads:</para>
                            <programlisting language="Bash">paths.script=/usr/share/cloudstack-common</programlisting>
                            <para>If not, add the line.</para>
                        </listitem>
                        <listitem>
                            <para>Restart the agent:</para>
                            <programlisting language="Bash">
                                service cloudstack-agent stop
                                killall jsvc
                                service cloudstack-agent start
                            </programlisting>
                        </listitem>
                    </orderedlist>
                </listitem>
                <listitem id="upgrade-rpm-packages-411">
                    <para>If you are using CentOS or RHEL, follow this procedure to upgrade your packages. If not, skip to step <xref linkend="restart-system-vms-411" />.</para> 
                    <note><title>Community Packages</title>
                        <para>This section assumes you're using the community supplied packages for &PRODUCT;. If you've created your own packages and yum repository, substitute your own URL for the ones used in these examples.</para>
                    </note>
                    <orderedlist id="rpmsteps-411">
                        <listitem>
                            <para>The first step is to confirm that your yum configuration is pointed at the correct repository for each system with &PRODUCT; packages. This means all management servers, and any hosts that have the KVM agent. (No changes should be necessary for hosts that are running VMware or Xen.)</para>
                            <para>Start by opening <filename>/etc/yum.repos.d/cloudstack.repo</filename> on any systems that have &PRODUCT; packages installed.</para>
                            <para>This file should have content similar to the following:</para>
                            <programlisting language="Bash">
                                [apache-cloudstack]
                                name=Apache CloudStack
                                baseurl=http://cloudstack.apt-get.eu/rhel/4.1/
                                enabled=1
                                gpgcheck=0
                            </programlisting>
                            <para>If the file above is not correct, correct it. Note that if you're using your own package repository, change the baseurl line to read as appropriate for your 4.1.1 repository.</para>
                        </listitem>
                        <listitem id="rpm-master-411">
                            <para>Now that you have the repository configured, it's time to update the <filename>cloudstack-management</filename> package.</para>
                            <programlisting language="Bash">$ sudo yum update cloudstack-management</programlisting>
                        </listitem>
                        <listitem id="kvm-agent-rpm-411">
                            <para>For KVM hosts, you will need to update the <filename>cloudstack-agent</filename> package.</para>
                            <programlisting language="Bash">$ sudo yum update cloudstack-agent</programlisting>
                        </listitem>
                        <listitem>
                            <para>Verify that the file <filename>/etc/cloudstack/agent/environment.properties</filename> has a line that reads:</para>
                            <programlisting language="Bash">paths.script=/usr/share/cloudstack-common</programlisting>
                            <para>If not, add the line.</para>
                        </listitem>
                        <listitem>
                            <para>Restart the agent:</para>
                            <programlisting language="Bash">
                                service cloudstack-agent stop
                                killall jsvc
                                service cloudstack-agent start
                            </programlisting>
                        </listitem>
                    </orderedlist>
                </listitem>
                <listitem id="restart-system-vms-411">
                    <para>Once you've upgraded the packages on your management servers, you'll need to restart the system VMs. Make sure port 8096 is open in your local host firewall to do this.</para>
                    <para>There is a script that will do this for you, all you need to do is run the script and supply the IP address for your MySQL instance and your MySQL credentials:</para>
                    <programlisting language="Bash"><prompt>#</prompt> nohup cloudstack-sysvmadm -d <replaceable>IP address</replaceable> -u cloud -p -a &gt; sysvm.log 2&gt;&amp;1 &amp;</programlisting>
                    <para>You can monitor the log for progress. The process of restarting the system VMs can take an hour or more.</para>
                    <programlisting language="Bash"><prompt>#</prompt> tail -f sysvm.log</programlisting>
                    <para>The output to <filename>sysvm.log</filename> will look something like this:</para>
                    <programlisting language="Bash">
                        Stopping and starting 1 secondary storage vm(s)...
                        Done stopping and starting secondary storage vm(s)
                        Stopping and starting 1 console proxy vm(s)...
                        Done stopping and starting console proxy vm(s).
                        Stopping and starting 4 running routing vm(s)...
                        Done restarting router(s).
                    </programlisting>
                </listitem>
            </orderedlist>
        </section>
        <section id="upgrade-from-4.0-to-4.1">
            <title>Upgrade from 4.0.x to 4.1.1</title>
            <para>This section will guide you from &PRODUCT; 4.0.x versions to &PRODUCT; 4.1.1.</para>
            <para>Any steps that are hypervisor-specific will be called out with a note.</para>
            <warning><title>Package Structure Changes</title>
                <para>The package structure for &PRODUCT; has changed significantly since the 4.0.x releases. If you've compiled your own packages, you'll notice that the package names and the number of packages has changed. This is <emphasis>not</emphasis> a bug.</para>
                <para>However, this <emphasis>does</emphasis> mean that the procedure is not as simple as an <command>apt-get upgrade</command> or <command>yum update</command>, so please follow this section carefully.</para>
            </warning>
            <para>We recommend reading through this section once or twice before beginning your upgrade procedure, and working through it on a test system before working on a production system.</para>
            <orderedlist>
                <listitem>
                    <para>Most users of &PRODUCT; manage the installation and upgrades of &PRODUCT; with one of Linux's predominant package systems, RPM or APT. This guide assumes you'll be using RPM and Yum (for Red Hat Enterprise Linux or CentOS), or APT and Debian packages (for Ubuntu).</para>
                    <para>Create RPM or Debian packages (as appropriate) and a repository from the 4.1.1 source, or check the &PRODUCT; downloads page at <ulink url="http://cloudstack.apache.org/downloads.html">http://cloudstack.apache.org/downloads.html</ulink> for package repositories supplied by community members. You will need them for step <xref linkend="upgrade-deb-packages" /> or step <xref linkend="upgrade-rpm-packages" />.</para>
                    <para>Instructions for creating packages from the &PRODUCT; source are in the <ulink url="http://cloudstack.apache.org/docs/en-US/index.html">Installation Guide</ulink>.</para>
                </listitem>
                <listitem>
                    <para>Stop your management server or servers. Run this on all management server hosts:</para>
                    <programlisting><prompt>#</prompt> service cloud-management stop</programlisting>
                </listitem>
                <listitem>
                    <para>If you are running a usage server or usage servers, stop those as well:</para>
                    <programlisting><prompt>#</prompt> service cloud-usage stop</programlisting>
                </listitem>
                <listitem>
                    <para>Make a backup of your MySQL database. If you run into any issues or need to roll back the upgrade, this will assist in debugging or restoring your existing environment. You'll be prompted for your password.</para>
                    <programlisting><prompt>#</prompt> mysqldump -u root -p cloud &gt; cloudstack-backup.sql</programlisting>
                </listitem>
                <listitem>
                    <para>If you have made changes to <filename>/etc/cloud/management/components.xml</filename>, you'll need to carry these over manually to the new file, <filename>/etc/cloudstack/management/componentContext.xml</filename>. This is not done automatically. (If you're unsure, we recommend making a backup of the original <filename>components.xml</filename> to be on the safe side.</para>
                </listitem>
                <listitem>
                    <para>After upgrading to 4.1, API clients are expected to send plain text passwords for login and user creation, instead of MD5 hash. Incase, api client changes are not acceptable, following changes are to be made for backward compatibility:</para>
                    <para>Modify componentsContext.xml, and make PlainTextUserAuthenticator as the default authenticator (1st entry in the userAuthenticators adapter list is default)</para>
                    <programlisting language="XML">
&lt;!-- Security adapters --&gt;
&lt;bean id="userAuthenticators" class="com.cloud.utils.component.AdapterList"&gt;
  &lt;property name="Adapters"&gt;
    &lt;list&gt;
      &lt;ref bean="PlainTextUserAuthenticator"/&gt;
      &lt;ref bean="MD5UserAuthenticator"/&gt;
      &lt;ref bean="LDAPUserAuthenticator"/&gt;
    &lt;/list&gt;
  &lt;/property&gt;
&lt;/bean&gt;
                    </programlisting>
                    <para>PlainTextUserAuthenticator works the same way MD5UserAuthenticator worked prior to 4.1.</para>
                </listitem>
                <listitem id="upgrade-deb-packages">
                    <para>If you are using Ubuntu, follow this procedure to upgrade your packages. If not, skip to step <xref linkend="upgrade-rpm-packages" />.</para> 
                    <note><title>Community Packages</title>
                        <para>This section assumes you're using the community supplied packages for &PRODUCT;. If you've created your own packages and APT repository, substitute your own URL for the ones used in these examples.</para>
                    </note>
                    <orderedlist id="debsteps">
                        <listitem>
                            <para>The first order of business will be to change the sources list for each system with &PRODUCT; packages. This means all management servers, and any hosts that have the KVM agent. (No changes should be necessary for hosts that are running VMware or Xen.)</para>
                            <para>Start by opening <filename>/etc/apt/sources.list.d/cloudstack.list</filename> on any systems that have &PRODUCT; packages installed.</para>
                            <para>This file should have one line, which contains:</para>
                            <programlisting language="Bash">deb http://cloudstack.apt-get.eu/ubuntu precise 4.0</programlisting>
                            <para>We'll change it to point to the new package repository:</para>
                            <programlisting language="Bash">deb http://cloudstack.apt-get.eu/ubuntu precise 4.1</programlisting>
                            <para>If you're using your own package repository, change this line to read as appropriate for your 4.1.1 repository.</para>
                        </listitem>
                        <listitem>
                            <para>Now update your apt package list:</para>
                            <programlisting language="Bash">$ sudo apt-get update</programlisting>
                        </listitem>
                        <listitem id="deb-master">
                            <para>Now that you have the repository configured, it's time to install the <filename>cloudstack-management</filename> package. This will pull in any other dependencies you need.</para>
                            <programlisting language="Bash">$ sudo apt-get install cloudstack-management</programlisting>
                        </listitem>
                        <listitem id="kvm-agent-deb">
                            <para>On KVM hosts you will need to manually install the <filename>cloudstack-agent</filename> package:</para>
                            <programlisting language="Bash">$ sudo apt-get install cloudstack-agent</programlisting>
                            <para>During the installation of <filename>cloudstack-agent</filename>, APT will copy your <filename>agent.properties</filename>, <filename>log4j-cloud.xml</filename>, and <filename>environment.properties</filename> from <filename>/etc/cloud/agent</filename> to <filename>/etc/cloudstack/agent</filename>.</para>
                            <para>When prompted whether you wish to keep your configuration, say Yes.</para>
                        </listitem>
                        <listitem>
                            <para>Verify that the file <filename>/etc/cloudstack/agent/environment.properties</filename> has a line that reads:</para>
                            <programlisting language="Bash">paths.script=/usr/share/cloudstack-common</programlisting>
                            <para>If not, add the line.</para>
                        </listitem>
                        <listitem>
                            <para>Restart the agent:</para>
                            <programlisting language="Bash">
                                service cloud-agent stop
                                killall jsvc
                                service cloudstack-agent start
                            </programlisting>
                        </listitem>
                        <listitem>
                            <para>During the upgrade, <filename>log4j-cloud.xml</filename> was simply copied over, so the logs will continue to be added to <filename>/var/log/cloud/agent/agent.log</filename>. There's nothing <emphasis>wrong</emphasis> with this, but if you prefer to be consistent, you can change this by copying over the sample configuration file:</para>
                            <programlisting language="Bash">
                                cd /etc/cloudstack/agent
                                mv log4j-cloud.xml.dpkg-dist log4j-cloud.xml
                                service cloudstack-agent restart
                            </programlisting>
                        </listitem>
                        <listitem>
                            <para>Once the agent is running, you can uninstall the old cloud-* packages from your system:</para>
                            <programlisting language="Bash">sudo dpkg --purge cloud-agent</programlisting>
                        </listitem> 
                    </orderedlist>
                </listitem>
                <listitem id="upgrade-rpm-packages">
                    <para>If you are using CentOS or RHEL, follow this procedure to upgrade your packages. If not, skip to step <xref linkend="restart-system-vms" />.</para> 
                    <note><title>Community Packages</title>
                        <para>This section assumes you're using the community supplied packages for &PRODUCT;. If you've created your own packages and yum repository, substitute your own URL for the ones used in these examples.</para>
                    </note>
                    <orderedlist id="rpmsteps">
                        <listitem>
                            <para>The first order of business will be to change the yum repository for each system with &PRODUCT; packages. This means all management servers, and any hosts that have the KVM agent. (No changes should be necessary for hosts that are running VMware or Xen.)</para>
                            <para>Start by opening <filename>/etc/yum.repos.d/cloudstack.repo</filename> on any systems that have &PRODUCT; packages installed.</para>
                            <para>This file should have content similar to the following:</para>
                            <programlisting language="Bash">
                                [apache-cloudstack]
                                name=Apache CloudStack
                                baseurl=http://cloudstack.apt-get.eu/rhel/4.0/
                                enabled=1
                                gpgcheck=0
                            </programlisting>
                            <para>If you are using the community provided package repository, change the baseurl to http://cloudstack.apt-get.eu/rhel/4.1/</para>
                            <para>If you're using your own package repository, change this line to read as appropriate for your 4.1.1 repository.</para>
                        </listitem>
                        <listitem id="rpm-master">
                            <para>Now that you have the repository configured, it's time to install the <filename>cloudstack-management</filename> package by upgrading the older <filename>cloud-client</filename> package.</para>
                            <programlisting language="Bash">$ sudo yum upgrade cloud-client</programlisting>
                        </listitem>
                        <listitem id="kvm-agent-rpm">
                            <para>For KVM hosts, you will need to upgrade the <filename>cloud-agent</filename> package, similarly installing the new version as <filename>cloudstack-agent</filename>.</para>
                            <programlisting language="Bash">$ sudo yum upgrade cloud-agent</programlisting>
                            <para>During the installation of <filename>cloudstack-agent</filename>, the RPM will copy your <filename>agent.properties</filename>, <filename>log4j-cloud.xml</filename>, and <filename>environment.properties</filename> from <filename>/etc/cloud/agent</filename> to <filename>/etc/cloudstack/agent</filename>.</para>
                        </listitem>
                        <listitem>
                            <para>Verify that the file <filename>/etc/cloudstack/agent/environment.properties</filename> has a line that reads:</para>
                            <programlisting language="Bash">paths.script=/usr/share/cloudstack-common</programlisting>
                            <para>If not, add the line.</para>
                        </listitem>
                        <listitem>
                            <para>Restart the agent:</para>
                            <programlisting language="Bash">
                                service cloud-agent stop
                                killall jsvc
                                service cloudstack-agent start
                            </programlisting>
                        </listitem>
                    </orderedlist>
                </listitem>
                <listitem id="restart-system-vms">
                    <para>Once you've upgraded the packages on your management servers, you'll need to restart the system VMs. Make sure port 8096 is open in your local host firewall to do this.</para>
                    <para>There is a script that will do this for you, all you need to do is run the script and supply the IP address for your MySQL instance and your MySQL credentials:</para>
                    <programlisting language="Bash"><prompt>#</prompt> nohup cloudstack-sysvmadm -d <replaceable>IP address</replaceable> -u cloud -p -a &gt; sysvm.log 2&gt;&amp;1 &amp;</programlisting>
                    <para>You can monitor the log for progress. The process of restarting the system VMs can take an hour or more.</para>
                    <programlisting language="Bash"><prompt>#</prompt> tail -f sysvm.log</programlisting>
                    <para>The output to <filename>sysvm.log</filename> will look something like this:</para>
                    <programlisting language="Bash">
                        Stopping and starting 1 secondary storage vm(s)...
                        Done stopping and starting secondary storage vm(s)
                        Stopping and starting 1 console proxy vm(s)...
                        Done stopping and starting console proxy vm(s).
                        Stopping and starting 4 running routing vm(s)...
                        Done restarting router(s).
                    </programlisting>
                </listitem>
                <listitem>
                    <note><title>For Xen Hosts: Copy vhd-utils</title>
                        <para>This step is only for CloudStack installs that are using Xen hosts.</para>
                    </note>
                    <para>Copy the file <filename>vhd-utils</filename> to <filename>/usr/share/cloudstack-common/scripts/vm/hypervisor/xenserver</filename>.</para>
                </listitem> 
            </orderedlist>
        </section>
        <section id="upgrade-from-3.0.2-to-4.0">
            <title>Upgrade from 3.0.2 to 4.1.1</title>
            <para>This section will guide you from Citrix CloudStack 3.0.2 to &PRODUCT; 4.1.1. Sections that are hypervisor-specific will be called out with a note.</para>
            <orderedlist>
                <listitem>
                    <note>
                        <para>The following upgrade instructions apply only if you're using VMware hosts. If
                            you're not using VMware hosts, skip this step and move on to <xref linkend="stopping-usage-servers" />.</para>
                    </note>
                    <para>In each zone that includes VMware hosts, you need to add a new system VM template. </para>
                    <orderedlist numeration="loweralpha">
                        <listitem>
                            <para>While running the existing 3.0.2 system, log in to the UI as root administrator.</para>
                        </listitem>
                        <listitem>
                            <para>In the left navigation bar, click Templates.</para>
                        </listitem>
                        <listitem>
                            <para>In Select view, click Templates.</para>
                        </listitem>
                        <listitem>
                            <para>Click Register template.</para>
                            <para>The Register template dialog box is displayed.</para>
                        </listitem>
                        <listitem>
                            <para>In the Register template dialog box, specify the following values (do not change these):</para>
                            <informaltable>
                                <tgroup cols="2" align="left" colsep="1" rowsep="1">
                                    <colspec colwidth="1*" colname="1" colnum="1"/>
                                    <colspec colwidth="2*" colname="2" colnum="2"/>
                                    <thead>
                                        <row>
                                            <entry><para>Field</para></entry>
                                            <entry><para>Value</para></entry>
                                        </row>
                                    </thead>
                                    <tbody>
                                        <row>
                                            <entry><para>Name</para></entry>
                                            <entry><para>systemvm-vmware-4.0</para></entry>
                                        </row>
                                        <row>
                                            <entry><para>Description</para></entry>
                                            <entry><para>systemvm-vmware-4.0</para></entry>
                                        </row>
                                        <row>
                                            <entry><para>URL</para></entry>
                                            <entry><para>http://download.cloud.com/templates/burbank/burbank-systemvm-08012012.ova</para></entry>
                                        </row>
                                        <row>
                                            <entry><para>Zone</para></entry>
                                            <entry><para>Choose the zone where this hypervisor is used</para></entry>
                                        </row>
                                        <row>
                                            <entry><para>Hypervisor</para></entry>
                                            <entry><para>VMware</para></entry>
                                        </row>
                                        <row>
                                            <entry><para>Format</para></entry>
                                            <entry><para>OVA</para></entry>
                                        </row>
                                        <row>
                                            <entry><para>OS Type</para></entry>
                                            <entry><para>Debian GNU/Linux 5.0 (32-bit)</para></entry>
                                        </row>
                                        <row>
                                            <entry><para>Extractable</para></entry>
                                            <entry><para>no</para></entry>
                                        </row>
                                        <row>
                                            <entry><para>Password Enabled</para></entry>
                                            <entry><para>no</para></entry>
                                        </row>
                                        <row>
                                            <entry><para>Public</para></entry>
                                            <entry><para>no</para></entry>
                                        </row>
                                        <row>
                                            <entry><para>Featured</para></entry>
                                            <entry><para>no</para></entry>
                                        </row>
                                    </tbody>
                                </tgroup>
                            </informaltable>
                        </listitem>
                        <listitem>
                            <para>Watch the screen to be sure that the template downloads successfully and enters
                                the READY state. Do not proceed until this is successful.</para>
                        </listitem>
                    </orderedlist>
                </listitem>
                <listitem id="stopping-usage-servers">
                    <para>Stop all Usage Servers if running. Run this on all Usage Server hosts.</para>
                    <programlisting language="Bash"><prompt>#</prompt> service cloud-usage stop</programlisting>
                </listitem>
                <listitem>
                    <para>Stop the Management Servers. Run this on all Management Server hosts.</para>
                    <programlisting language="Bash"><prompt>#</prompt> service cloud-management stop</programlisting>
                </listitem>
                <listitem>
                    <para>On the MySQL master, take a backup of the MySQL databases. We recommend performing
                        this step even in test upgrades. If there is an issue, this will assist with
                        debugging.</para>
                    <para>In the following commands, it is assumed that you have set the root password on the
                        database, which is a CloudStack recommended best practice. Substitute your own MySQL
                        root password.</para>
                    <programlisting><prompt>#</prompt> <command>mysqldump</command> -u root -p<replaceable>mysql_password</replaceable> cloud > <filename>cloud-backup.dmp</filename>
                        <prompt>#</prompt> <command>mysqldump</command> -u root -p<replaceable>mysql_password</replaceable> cloud_usage > <filename>cloud-usage-backup.dmp</filename></programlisting>
                </listitem>
                <listitem>
                    <para>Either build RPM/DEB packages as detailed in the Installation Guide, or use one of
                        the community provided yum/apt repositories to gain access to the &PRODUCT;
                        binaries.</para>
                </listitem>
                <listitem id="upgrade-deb-packages-302">
                    <para>If you are using Ubuntu, follow this procedure to upgrade your packages. If not, skip to step <xref linkend="upgrade-rpm-packages-302" />.</para> 
                    <note><title>Community Packages</title>
                        <para>This section assumes you're using the community supplied packages for &PRODUCT;. If you've created your own packages and APT repository, substitute your own URL for the ones used in these examples.</para>
                    </note>
                    <orderedlist id="debsteps-302">
                        <listitem>
                            <para>The first order of business will be to change the sources list for each system with &PRODUCT; packages. This means all management servers, and any hosts that have the KVM agent. (No changes should be necessary for hosts that are running VMware or Xen.)</para>
                            <para>Start by opening <filename>/etc/apt/sources.list.d/cloudstack.list</filename> on any systems that have &PRODUCT; packages installed.</para>
                            <para>This file should have one line, which contains:</para>
                            <programlisting language="Bash">deb http://cloudstack.apt-get.eu/ubuntu precise 4.0</programlisting>
                            <para>We'll change it to point to the new package repository:</para>
                            <programlisting language="Bash">deb http://cloudstack.apt-get.eu/ubuntu precise 4.1</programlisting>
                            <para>If you're using your own package repository, change this line to read as appropriate for your 4.1.1 repository.</para>
                        </listitem>
                        <listitem>
                            <para>Now update your apt package list:</para>
                            <programlisting language="Bash">$ sudo apt-get update</programlisting>
                        </listitem>
                        <listitem id="deb-master-302">
                            <para>Now that you have the repository configured, it's time to install the <filename>cloudstack-management</filename> package. This will pull in any other dependencies you need.</para>
                            <programlisting language="Bash">$ sudo apt-get install cloudstack-management</programlisting>
                        </listitem>
                        <listitem id="kvm-agent-deb-302">
                            <para>On KVM hosts you will need to manually install the <filename>cloudstack-agent</filename> package:</para>
                            <programlisting language="Bash">$ sudo apt-get install cloudstack-agent</programlisting>
                            <para>During the installation of <filename>cloudstack-agent</filename>, APT will copy your <filename>agent.properties</filename>, <filename>log4j-cloud.xml</filename>, and <filename>environment.properties</filename> from <filename>/etc/cloud/agent</filename> to <filename>/etc/cloudstack/agent</filename>.</para>
                            <para>When prompted whether you wish to keep your configuration, say Yes.</para>
                        </listitem>
                        <listitem>
                            <para>Verify that the file <filename>/etc/cloudstack/agent/environment.properties</filename> has a line that reads:</para>
                            <programlisting language="Bash">paths.script=/usr/share/cloudstack-common</programlisting>
                            <para>If not, add the line.</para>
                        </listitem>
                        <listitem>
                            <para>Restart the agent:</para>
                            <programlisting language="Bash">
                                service cloud-agent stop
                                killall jsvc
                                service cloudstack-agent start
                            </programlisting>
                        </listitem>
                        <listitem>
                            <para>During the upgrade, <filename>log4j-cloud.xml</filename> was simply copied over, so the logs will continue to be added to <filename>/var/log/cloud/agent/agent.log</filename>. There's nothing <emphasis>wrong</emphasis> with this, but if you prefer to be consistent, you can change this by copying over the sample configuration file:</para>
                            <programlisting language="Bash">
                                cd /etc/cloudstack/agent
                                mv log4j-cloud.xml.dpkg-dist log4j-cloud.xml
                                service cloudstack-agent restart
                            </programlisting>
                        </listitem>
                        <listitem>
                            <para>Once the agent is running, you can uninstall the old cloud-* packages from your system:</para>
                            <programlisting language="Bash">sudo dpkg --purge cloud-agent</programlisting>
                        </listitem> 
                    </orderedlist>
                </listitem>
                <listitem id="upgrade-rpm-packages-302">
                    <para>If you are using CentOS or RHEL, follow this procedure to upgrade your packages. If not, skip to step <xref linkend="correct-components-xml-302" />.</para> 
                    <note><title>Community Packages</title>
                        <para>This section assumes you're using the community supplied packages for &PRODUCT;. If you've created your own packages and yum repository, substitute your own URL for the ones used in these examples.</para>
                    </note>
                    <orderedlist id="rpmsteps-302">
                        <listitem>
                            <para>The first order of business will be to change the yum repository for each system with &PRODUCT; packages. This means all management servers, and any hosts that have the KVM agent. (No changes should be necessary for hosts that are running VMware or Xen.)</para>
                            <para>Start by opening <filename>/etc/yum.repos.d/cloudstack.repo</filename> on any systems that have &PRODUCT; packages installed.</para>
                            <para>This file should have content similar to the following:</para>
                            <programlisting language="Bash">
                                [apache-cloudstack]
                                name=Apache CloudStack
                                baseurl=http://cloudstack.apt-get.eu/rhel/4.0/
                                enabled=1
                                gpgcheck=0
                            </programlisting>
                            <para>If you are using the community provided package repository, change the baseurl to http://cloudstack.apt-get.eu/rhel/4.1/</para>
                            <para>If you're using your own package repository, change this line to read as appropriate for your 4.1.1 repository.</para>
                        </listitem>
                        <listitem id="rpm-master-302">
                            <para>Now that you have the repository configured, it's time to install the <filename>cloudstack-management</filename> package by upgrading the older <filename>cloud-client</filename> package.</para>
                            <programlisting language="Bash">$ sudo yum upgrade cloud-client</programlisting>
                        </listitem>
                        <listitem id="kvm-agent-rpm-302">
                            <para>For KVM hosts, you will need to upgrade the <filename>cloud-agent</filename> package, similarly installing the new version as <filename>cloudstack-agent</filename>.</para>
                            <programlisting language="Bash">$ sudo yum upgrade cloud-agent</programlisting>
                            <para>During the installation of <filename>cloudstack-agent</filename>, the RPM will copy your <filename>agent.properties</filename>, <filename>log4j-cloud.xml</filename>, and <filename>environment.properties</filename> from <filename>/etc/cloud/agent</filename> to <filename>/etc/cloudstack/agent</filename>.</para>
                        </listitem>
                        <listitem>
                            <para>Verify that the file <filename>/etc/cloudstack/agent/environment.properties</filename> has a line that reads:</para>
                            <programlisting language="Bash">paths.script=/usr/share/cloudstack-common</programlisting>
                            <para>If not, add the line.</para>
                        </listitem>
                        <listitem>
                            <para>Restart the agent:</para>
                            <programlisting language="Bash">
                                service cloud-agent stop
                                killall jsvc
                                service cloudstack-agent start
                            </programlisting>
                        </listitem>
                    </orderedlist>
                </listitem>
                <listitem id="correct-components-xml-302">
                    <para>If you have made changes to your copy of
                        <filename>/etc/cloud/management/components.xml</filename> the changes will be
                        preserved in the upgrade. However, you need to do the following steps to place these
                        changes in a new version of the file which is compatible with version
                        4.1.1.</para>
                    <orderedlist numeration="loweralpha">
                        <listitem>
                            <para>Make a backup copy of <filename>/etc/cloud/management/components.xml</filename>.
                                For example:</para>
                            <programlisting># mv /etc/cloud/management/components.xml /etc/cloud/management/components.xml-backup</programlisting>
                        </listitem>
                        <listitem>
                            <para>Copy <filename>/etc/cloud/management/components.xml.rpmnew</filename> to create
                                a new <filename>/etc/cloud/management/components.xml</filename>:</para>
                            <programlisting># cp -ap /etc/cloud/management/components.xml.rpmnew /etc/cloud/management/components.xml</programlisting>
                        </listitem>
                        <listitem>
                            <para>Merge your changes from the backup file into the new
                                <filename>components.xml</filename>.</para>
                            <programlisting># vi /etc/cloud/management/components.xml</programlisting>
                        </listitem>
                    </orderedlist>
                    <note>
                        <para>If you have more than one management server node, repeat the upgrade steps on each
                            node.</para>
                    </note>
                </listitem>
                <listitem>
                    <para>After upgrading to 4.1, API clients are expected to send plain text passwords for login and user creation, instead of MD5 hash. Incase, api client changes are not acceptable, following changes are to be made for backward compatibility:</para>
                    <para>Modify componentsContext.xml, and make PlainTextUserAuthenticator as the default authenticator (1st entry in the userAuthenticators adapter list is default)</para>
                    <programlisting language="XML">
&lt;!-- Security adapters --&gt;
&lt;bean id="userAuthenticators" class="com.cloud.utils.component.AdapterList"&gt;
  &lt;property name="Adapters"&gt;
    &lt;list&gt;
      &lt;ref bean="PlainTextUserAuthenticator"/&gt;
      &lt;ref bean="MD5UserAuthenticator"/&gt;
      &lt;ref bean="LDAPUserAuthenticator"/&gt;
    &lt;/list&gt;
  &lt;/property&gt;
&lt;/bean&gt;
                    </programlisting>
                    <para>PlainTextUserAuthenticator works the same way MD5UserAuthenticator worked prior to 4.1.</para>
                </listitem>
                <listitem>
                    <para>Start the first Management Server. Do not start any other Management Server nodes
                        yet.</para>
                    <programlisting language="Bash"><prompt>#</prompt> service cloudstack-management start</programlisting>
                    <para>Wait until the databases are upgraded. Ensure that the database upgrade is complete.
                        After confirmation, start the other Management Servers one at a time by running the same
                        command on each node.</para>
                    <note>
                        <para>Failing to restart the Management Server indicates a problem in the upgrade.
                            Having the Management Server restarted without any issues indicates that the upgrade
                            is successfully completed.</para>
                    </note>
                </listitem>
                <listitem>
                    <para>Start all Usage Servers (if they were running on your previous version). Perform
                        this on each Usage Server host.</para>
                    <para><command># service cloudstack-usage start</command></para>
                </listitem>
                <listitem>
                    <note>
                        <para>Additional steps are required for each KVM host. These steps will not affect
                            running guests in the cloud. These steps are required only for clouds using KVM as
                            hosts and only on the KVM hosts.</para>
                    </note>
                    <orderedlist numeration="loweralpha">
                        <listitem>
                            <para>Configure a yum or apt respository containing the &PRODUCT; packages as outlined
                                in the Installation Guide.</para>
                        </listitem>
                        <listitem>
                            <para>Stop the running agent.</para>
                            <para><command># service cloud-agent stop</command></para>
                        </listitem>
                        <listitem>
                            <para>Update the agent software with one of the following command sets as appropriate
                                for your environment.</para>
                            <para><command># yum update cloud*</command></para>
                            <para><command># apt-get update</command></para>
                            <para><command># apt-get upgrade cloud*</command></para>
                        </listitem>
                        <listitem>
                            <para>Start the agent.</para>
                            <programlisting># service cloudstack-agent start</programlisting>
                        </listitem>
                        <listitem>
                            <para>Edit <filename>/etc/cloud/agent/agent.properties</filename> to change the
                                resource parameter from
                                "com.cloud.agent.resource.computing.LibvirtComputingResource" to
                                "com.cloud.hypervisor.kvm.resource.LibvirtComputingResource".</para>
                        </listitem>
                        <listitem>
                            <para>Start the cloud agent and cloud management services.</para>
                        </listitem>
                        <listitem>
                            <para>When the Management Server is up and running, log in to the CloudStack UI and
                                restart the virtual router for proper functioning of all the features.</para>
                        </listitem>
                    </orderedlist>
                </listitem>
                <listitem>
                    <para>Log in to the CloudStack UI as administrator, and check the status of the hosts. All
                        hosts should come to Up state (except those that you know to be offline). You may need
                        to wait 20 or 30 minutes, depending on the number of hosts.</para>
                    <note>
                        <para>Troubleshooting: If login fails, clear your browser cache and reload the
                            page.</para>
                    </note>
                    <para/>
                    <para>Do not proceed to the next step until the hosts show in Up state.</para>
                </listitem>
                <listitem>
                    <para>If you are upgrading from 3.0.2, perform the following:</para>
                    <orderedlist numeration="loweralpha">
                        <listitem>
                            <para>Ensure that the admin port is set to 8096 by using the "integration.api.port"
                                global parameter.</para>
                            <para>This port is used by the cloud-sysvmadm script at the end of the upgrade
                                procedure. For information about how to set this parameter, see "Setting Global
                                Configuration Parameters" in the Installation Guide.</para>
                        </listitem>
                        <listitem>
                            <para>Restart the Management Server.</para>
                            <note>
                                <para>If you don't want the admin port to remain open, you can set it to null after
                                    the upgrade is done and restart the management server.</para>
                            </note>
                        </listitem>
                    </orderedlist>
                </listitem>
                <listitem>
                    <para>Run the <command>cloud-sysvmadm</command> script to stop, then start, all Secondary
                        Storage VMs, Console Proxy VMs, and virtual routers. Run the script once on each
                        management server. Substitute your own IP address of the MySQL instance, the MySQL user
                        to connect as, and the password to use for that user. In addition to those parameters,
                        provide the <command>-c</command> and <command>-r</command> arguments. For
                        example:</para>
                    <para><command># nohup cloud-sysvmadm -d 192.168.1.5 -u cloud -p password -c -r >
                            sysvm.log 2>&amp;1 &amp;</command></para>
                    <para><command># tail -f sysvm.log</command></para>
                    <para>This might take up to an hour or more to run, depending on the number of accounts in
                        the system.</para>
                </listitem>
                <listitem>
                    <para>If needed, upgrade all Citrix XenServer hypervisor hosts in your cloud to a version
                        supported by CloudStack 4.1.1. The supported versions are XenServer 5.6 SP2
                        and 6.0.2. Instructions for upgrade can be found in the CloudStack 4.1.1
                        Installation Guide under "Upgrading XenServer Versions."</para>
                </listitem>
                <listitem>
                    <para>Now apply the XenServer hotfix XS602E003 (and any other needed hotfixes) to
                        XenServer v6.0.2 hypervisor hosts.</para>
                    <orderedlist numeration="loweralpha">
                        <listitem>
                            <para>Disconnect the XenServer cluster from CloudStack.</para>
                            <para>In the left navigation bar of the CloudStack UI, select Infrastructure. Under
                                Clusters, click View All. Select the XenServer cluster and click Actions -
                                Unmanage.</para>
                            <para>This may fail if there are hosts not in one of the states Up, Down,
                                Disconnected, or Alert. You may need to fix that before unmanaging this
                                cluster.</para>
                            <para>Wait until the status of the cluster has reached Unmanaged. Use the CloudStack
                                UI to check on the status. When the cluster is in the unmanaged state, there is no
                                connection to the hosts in the cluster.</para>
                        </listitem>
                        <listitem>
                            <para>To clean up the VLAN, log in to one XenServer host and run:</para>
                            <para><command>/opt/xensource/bin/cloud-clean-vlan.sh</command></para>
                        </listitem>
                        <listitem>
                            <para>Now prepare the upgrade by running the following on one XenServer host:</para>
                            <para><command>/opt/xensource/bin/cloud-prepare-upgrade.sh</command></para>
                            <para>If you see a message like "can't eject CD", log in to the VM and unmount the CD,
                                then run this script again.</para>
                        </listitem>
                        <listitem>
                            <para>Upload the hotfix to the XenServer hosts. Always start with the Xen pool master,
                                then the slaves. Using your favorite file copy utility (e.g. WinSCP), copy the
                                hotfixes to the host. Place them in a temporary folder such as /tmp. </para>
                            <para>On the Xen pool master, upload the hotfix with this command:</para>
                            <para><command>xe patch-upload file-name=XS602E003.xsupdate</command></para>
                            <para>Make a note of the output from this command, which is a UUID for the hotfix
                                file. You'll need it in another step later.</para>
                            <note>
                                <para>(Optional) If you are applying other hotfixes as well, you can repeat the
                                    commands in this section with the appropriate hotfix number. For example,
                                    XS602E004.xsupdate.</para>
                            </note>
                        </listitem>
                        <listitem>
                            <para>Manually live migrate all VMs on this host to another host. First, get a list of
                                the VMs on this host:</para>
                            <para><command># xe vm-list</command></para>
                            <para>Then use this command to migrate each VM. Replace the example host name and VM
                                name with your own:</para>
                            <para><command># xe vm-migrate live=true host=<replaceable>host-name</replaceable>
                                    vm=<replaceable>VM-name</replaceable></command></para>
                            <note>
                                <title>Troubleshooting</title>
                                <para>If you see a message like "You attempted an operation on a VM which requires
                                    PV drivers to be installed but the drivers were not detected," run:</para>
                                <para><command>/opt/xensource/bin/make_migratable.sh
                                        b6cf79c8-02ee-050b-922f-49583d9f1a14</command>.</para>
                            </note>
                        </listitem>
                        <listitem>
                            <para>Apply the hotfix. First, get the UUID of this host:</para>
                            <programlisting># xe host-list</programlisting>
                            <para>Then use the following command to apply the hotfix. Replace the example host
                                UUID with the current host ID, and replace the hotfix UUID with the output from the
                                patch-upload command you ran on this machine earlier. You can also get the hotfix
                                UUID by running xe patch-list. </para>
                            <programlisting><command>xe</command> patch-apply host-uuid=<replaceable>host-uuid</replaceable> uuid=<replaceable>hotfix-uuid</replaceable></programlisting>
                        </listitem>
                        <listitem>
                            <para>Copy the following files from the CloudStack Management Server to the
                                host.</para>
                            <informaltable>
                                <tgroup cols="2" align="left" colsep="1" rowsep="1">
                                    <colspec colwidth="1*" colname="1" colnum="1"/>
                                    <colspec colwidth="2*" colname="2" colnum="2"/>
                                    <thead>
                                        <row>
                                            <entry><para>Copy from here...</para></entry>
                                            <entry><para>...to here</para></entry>
                                        </row>
                                    </thead>
                                    <tbody>
                                        <row>
                                            <entry><para>/usr/share/cloudstack-common/scripts/vm/hypervisor/xenserver/xenserver60/NFSSR.py</para></entry>
                                            <entry><para>/opt/xensource/sm/NFSSR.py</para></entry>
                                        </row>
                                        <row>
                                            <entry><para>/usr/share/cloudstack-common/scripts/vm/hypervisor/xenserver/setupxenserver.sh</para></entry>
                                            <entry><para>/opt/xensource/bin/setupxenserver.sh</para></entry>
                                        </row>
                                        <row>
                                            <entry><para>/usr/share/cloudstack-common/scripts/vm/hypervisor/xenserver/make_migratable.sh</para></entry>
                                            <entry><para>/opt/xensource/bin/make_migratable.sh</para></entry>
                                        </row>
                                    </tbody>
                                </tgroup>
                            </informaltable>
                        </listitem>
                        <listitem>
                            <para>(Only for hotfixes XS602E005 and XS602E007) You need to apply a new Cloud
                                Support Pack.</para>
                            <itemizedlist>
                                <listitem>
                                    <para>Download the CSP software onto the XenServer host from one of the following
                                        links:</para>
                                    <para>For hotfix XS602E005: <ulink
                                            url="http://coltrane.eng.hq.xensource.com/release/XenServer-6.x/XS-6.0.2/hotfixes/XS602E005/56710/xe-phase-2/xenserver-cloud-supp.tgz"
                                            >http://coltrane.eng.hq.xensource.com/release/XenServer-6.x/XS-6.0.2/hotfixes/XS602E005/56710/xe-phase-2/xenserver-cloud-supp.tgz</ulink></para>
                                    <para>For hotfix XS602E007: <ulink
                                            url="http://coltrane.eng.hq.xensource.com/release/XenServer-6.x/XS-6.0.2/hotfixes/XS602E007/57824/xe-phase-2/xenserver-cloud-supp.tgz"
                                            >http://coltrane.eng.hq.xensource.com/release/XenServer-6.x/XS-6.0.2/hotfixes/XS602E007/57824/xe-phase-2/xenserver-cloud-supp.tgz</ulink></para>
                                </listitem>
                                <listitem>
                                    <para>Extract the file:</para>
                                    <programlisting># tar xf xenserver-cloud-supp.tgz</programlisting>
                                </listitem>
                                <listitem>
                                    <para>Run the following script:</para>
                                    <programlisting># xe-install-supplemental-pack xenserver-cloud-supp.iso</programlisting>
                                </listitem>
                                <listitem>
                                    <para>If the XenServer host is part of a zone that uses basic networking, disable
                                        Open vSwitch (OVS):</para>
                                    <programlisting># xe-switch-network-backend  bridge</programlisting>
                                </listitem>
                            </itemizedlist>
                        </listitem>
                        <listitem>
                            <para>Reboot this XenServer host.</para>
                        </listitem>
                        <listitem>
                            <para>Run the following:</para>
                            <programlisting>/opt/xensource/bin/setupxenserver.sh</programlisting>
                            <note>
                                <para>If the message "mv: cannot stat `/etc/cron.daily/logrotate': No such file or
                                    directory" appears, you can safely ignore it.</para>
                            </note>
                        </listitem>
                        <listitem>
                            <para>Run the following:</para>
                            <programlisting>for pbd in `xe pbd-list currently-attached=false| grep ^uuid | awk '{print $NF}'`; do xe pbd-plug uuid=$pbd ; </programlisting>
                        </listitem>
                        <listitem>
                            <para>On each slave host in the Xen pool, repeat these steps, starting from "manually
                                live migrate VMs."</para>
                        </listitem>
                    </orderedlist>
                </listitem>
            </orderedlist>
            <note>
                <title>Troubleshooting Tip</title>
                <para>If passwords which you know to be valid appear not to work after upgrade, or other UI
                    issues are seen, try clearing your browser cache and reloading the UI page.</para>
            </note>
        </section>
        <section id="upgrade-from-2.2.x-to-4.1">
            <title>Upgrade from 2.2.14 to 4.1.1</title>
            <orderedlist>
                <listitem>
                    <para>Ensure that you query your IPaddress usage records and process them; for example,
                        issue invoices for any usage that you have not yet billed users for.</para>
                    <para>Starting in 3.0.2, the usage record format for IP addresses is the same as the rest
                        of the usage types. Instead of a single record with the assignment and release dates,
                        separate records are generated per aggregation period with start and end dates. After
                        upgrading to 4.1.1, any existing IP address usage records in the old format
                        will no longer be available.</para>
                </listitem>
                <listitem>
                    <para>If you are using version 2.2.0 - 2.2.13, first upgrade to 2.2.14 by using the
                        instructions in the <ulink url="http://download.cloud.com/releases/2.2.0/CloudStack2.2.14ReleaseNotes.pdf">2.2.14 Release Notes</ulink>.</para>
                    <warning>
                        <title>KVM Hosts</title>
                        <para>If KVM hypervisor is used in your cloud, be sure you completed the step to insert
                            a valid username and password into the host_details table on each KVM node as
                            described in the 2.2.14 Release Notes. This step is critical, as the database will be
                            encrypted after the upgrade to 4.1.1.</para>
                    </warning>
                </listitem>
                <listitem>
                    <para>While running the 2.2.14 system, log in to the UI as root administrator.</para>
                </listitem>
                <listitem>
                    <para>Using the UI, add a new System VM template for each hypervisor type that is used in
                        your cloud. In each zone, add a system VM template for each hypervisor used in that
                        zone</para>
                    <orderedlist>
                        <listitem>
                            <para>In the left navigation bar, click Templates.</para>
                        </listitem>
                        <listitem>
                            <para>In Select view, click Templates.</para>
                        </listitem>
                        <listitem>
                            <para>Click Register template.</para>
                            <para>The Register template dialog box is displayed.</para>
                        </listitem>
                        <listitem>
                            <para>In the Register template dialog box, specify the following values depending on
                                the hypervisor type (do not change these):</para>
                            <informaltable>
                                <tgroup cols="2" align="left" colsep="1" rowsep="1">
                                    <colspec colwidth="1*" colname="1" colnum="1"/>
                                    <colspec colwidth="2*" colname="2" colnum="2"/>
                                    <thead>
                                        <row>
                                            <entry><para>Hypervisor</para></entry>
                                            <entry><para>Description</para></entry>
                                        </row>
                                    </thead>
                                    <tbody>
                                        <row>
                                            <entry><para>XenServer</para></entry>
                                            <entry><para>Name: systemvm-xenserver-3.0.0</para>
                                                <para>Description: systemvm-xenserver-3.0.0</para>
                                                <para>URL:
                                                    http://download.cloud.com/templates/acton/acton-systemvm-02062012.vhd.bz2</para>
                                                <para>Zone: Choose the zone where this hypervisor is used</para>
                                                <para>Hypervisor: XenServer</para>
                                                <para>Format: VHD</para>
                                                <para>OS Type: Debian GNU/Linux 5.0 (32-bit)</para>
                                                <para>Extractable: no</para>
                                                <para>Password Enabled: no</para>
                                                <para>Public: no</para>
                                                <para>Featured: no</para>
                                            </entry>
                                        </row>
                                        <row>
                                            <entry><para>KVM</para></entry>
                                            <entry><para>Name: systemvm-kvm-3.0.0</para>
                                                <para>Description: systemvm-kvm-3.0.0</para>
                                                <para>URL:
                                                    http://download.cloud.com/templates/acton/acton-systemvm-02062012.qcow2.bz2</para>
                                                <para>Zone: Choose the zone where this hypervisor is used</para>
                                                <para>Hypervisor: KVM</para>
                                                <para>Format: QCOW2</para>
                                                <para>OS Type: Debian GNU/Linux 5.0 (32-bit)</para>
                                                <para>Extractable: no</para>
                                                <para>Password Enabled: no</para>
                                                <para>Public: no</para>
                                                <para>Featured: no</para>
                                            </entry>
                                        </row>
                                        <row>
                                            <entry><para>VMware</para></entry>
                                            <entry><para>Name: systemvm-vmware-4.0</para>
                                                <para>Description: systemvm-vmware-4.0</para>
                                                <para>URL:
                                                    http://download.cloud.com/templates/burbank/burbank-systemvm-08012012.ova</para>
                                                <para>Zone: Choose the zone where this hypervisor is used</para>
                                                <para>Hypervisor: VMware</para>
                                                <para>Format: OVA</para>
                                                <para>OS Type: Debian GNU/Linux 5.0 (32-bit)</para>
                                                <para>Extractable: no</para>
                                                <para>Password Enabled: no</para>
                                                <para>Public: no</para>
                                                <para>Featured: no</para>
                                            </entry>
                                        </row>
                                    </tbody>
                                </tgroup>
                            </informaltable>
                        </listitem>
                    </orderedlist>
                </listitem>
                <listitem>
                    <para>Watch the screen to be sure that the template downloads successfully and enters the
                        READY state. Do not proceed until this is successful</para>
                </listitem>
                <listitem>
                    <para><emphasis role="bold">WARNING</emphasis>: If you use more than one type of
                        hypervisor in your cloud, be sure you have repeated these steps to download the system
                        VM template for each hypervisor type. Otherwise, the upgrade will fail.</para>
                </listitem>
                <listitem>
                    <para>Stop all Usage Servers if running. Run this on all Usage Server hosts.</para>
                    <programlisting># service cloud-usage stop</programlisting>
                </listitem>
                <listitem>
                    <para>Stop the Management Servers. Run this on all Management Server hosts.</para>
                    <programlisting language="Bash"><prompt>#</prompt> service cloud-management stop</programlisting>
                </listitem>
                <listitem>
                    <para>On the MySQL master, take a backup of the MySQL databases. We recommend performing
                        this step even in test upgrades. If there is an issue, this will assist with
                        debugging.</para>
                    <para>In the following commands, it is assumed that you have set the root password on the
                        database, which is a CloudStack recommended best practice. Substitute your own MySQL
                        root password.</para>
                    <programlisting><prompt>#</prompt> <command>mysqldump</command> -u root -p<replaceable>mysql_password</replaceable> cloud > <filename>cloud-backup.dmp</filename>
                        <prompt>#</prompt> <command>mysqldump</command> -u root -p<replaceable>mysql_password</replaceable> cloud_usage > <filename>cloud-usage-backup.dmp</filename>
                    </programlisting>
                </listitem>
                <listitem>
                    <para> Either build RPM/DEB packages as detailed in the Installation Guide, or use one of
                        the community provided yum/apt repositories to gain access to the &PRODUCT; binaries.
                    </para>
                </listitem>
                <listitem id="upgrade-deb-packages-22">
                    <para>If you are using Ubuntu, follow this procedure to upgrade your packages. If not, skip to step <xref linkend="upgrade-rpm-packages-22" />.</para> 
                    <note><title>Community Packages</title>
                        <para>This section assumes you're using the community supplied packages for &PRODUCT;. If you've created your own packages and APT repository, substitute your own URL for the ones used in these examples.</para>
                    </note>
                    <orderedlist id="debsteps-22">
                        <listitem>
                            <para>The first order of business will be to change the sources list for each system with &PRODUCT; packages. This means all management servers, and any hosts that have the KVM agent. (No changes should be necessary for hosts that are running VMware or Xen.)</para>
                            <para>Start by opening <filename>/etc/apt/sources.list.d/cloudstack.list</filename> on any systems that have &PRODUCT; packages installed.</para>
                            <para>This file should have one line, which contains:</para>
                            <programlisting language="Bash">deb http://cloudstack.apt-get.eu/ubuntu precise 4.0</programlisting>
                            <para>We'll change it to point to the new package repository:</para>
                            <programlisting language="Bash">deb http://cloudstack.apt-get.eu/ubuntu precise 4.1</programlisting>
                            <para>If you're using your own package repository, change this line to read as appropriate for your 4.1.1 repository.</para>
                        </listitem>
                        <listitem>
                            <para>Now update your apt package list:</para>
                            <programlisting language="Bash">$ sudo apt-get update</programlisting>
                        </listitem>
                        <listitem id="deb-master-22">
                            <para>Now that you have the repository configured, it's time to install the <filename>cloudstack-management</filename> package. This will pull in any other dependencies you need.</para>
                            <programlisting language="Bash">$ sudo apt-get install cloudstack-management</programlisting>
                        </listitem>
                        <listitem id="kvm-agent-deb-22">
                            <para>on KVM hosts you will need to manually install the <filename>cloudstack-agent</filename> package:</para>
                            <programlisting language="Bash">$ sudo apt-get install cloudstack-agent</programlisting>
                            <para>During the installation of <filename>cloudstack-agent</filename>, APT will copy your <filename>agent.properties</filename>, <filename>log4j-cloud.xml</filename>, and <filename>environment.properties</filename> from <filename>/etc/cloud/agent</filename> to <filename>/etc/cloudstack/agent</filename>.</para>
                            <para>When prompted whether you wish to keep your configuration, say Yes.</para>
                        </listitem>
                        <listitem>
                            <para>Verify that the file <filename>/etc/cloudstack/agent/environment.properties</filename> has a line that reads:</para>
                            <programlisting language="Bash">paths.script=/usr/share/cloudstack-common</programlisting>
                            <para>If not, add the line.</para>
                        </listitem>
                        <listitem>
                            <para>Restart the agent:</para>
                            <programlisting language="Bash">
                                service cloud-agent stop
                                killall jsvc
                                service cloudstack-agent start
                            </programlisting>
                        </listitem>
                        <listitem>
                            <para>During the upgrade, <filename>log4j-cloud.xml</filename> was simply copied over, so the logs will continue to be added to <filename>/var/log/cloud/agent/agent.log</filename>. There's nothing <emphasis>wrong</emphasis> with this, but if you prefer to be consistent, you can change this by copying over the sample configuration file:</para>
                            <programlisting language="Bash">
                                cd /etc/cloudstack/agent
                                mv log4j-cloud.xml.dpkg-dist log4j-cloud.xml
                                service cloudstack-agent restart
                            </programlisting>
                        </listitem>
                        <listitem>
                            <para>Once the agent is running, you can uninstall the old cloud-* packages from your system:</para>
                            <programlisting language="Bash">sudo dpkg --purge cloud-agent</programlisting>
                        </listitem> 
                    </orderedlist>
                </listitem>
                <listitem id="upgrade-rpm-packages-22">
                    <para>If you are using CentOS or RHEL, follow this procedure to upgrade your packages. If not, skip to step <xref linkend="correct-components-xml-22" />.</para> 
                    <note><title>Community Packages</title>
                        <para>This section assumes you're using the community supplied packages for &PRODUCT;. If you've created your own packages and yum repository, substitute your own URL for the ones used in these examples.</para>
                    </note>
                    <orderedlist id="rpmsteps-22">
                        <listitem>
                            <para>The first order of business will be to change the yum repository for each system with &PRODUCT; packages. This means all management servers, and any hosts that have the KVM agent. (No changes should be necessary for hosts that are running VMware or Xen.)</para>
                            <para>Start by opening <filename>/etc/yum.repos.d/cloudstack.repo</filename> on any systems that have &PRODUCT; packages installed.</para>
                            <para>This file should have content similar to the following:</para>
                            <programlisting language="Bash">
                                [apache-cloudstack]
                                name=Apache CloudStack
                                baseurl=http://cloudstack.apt-get.eu/rhel/4.0/
                                enabled=1
                                gpgcheck=0
                            </programlisting>
                            <para>If you are using the community provided package repository, change the baseurl to http://cloudstack.apt-get.eu/rhel/4.1/</para>
                            <para>If you're using your own package repository, change this line to read as appropriate for your 4.1.1 repository.</para>
                        </listitem>
                        <listitem id="rpm-master-22">
                            <para>Now that you have the repository configured, it's time to install the <filename>cloudstack-management</filename> package by upgrading the older <filename>cloud-client</filename> package.</para>
                            <programlisting language="Bash">$ sudo yum upgrade cloud-client</programlisting>
                        </listitem>
                        <listitem id="kvm-agent-rpm-22">
                            <para>For KVM hosts, you will need to upgrade the <filename>cloud-agent</filename> package, similarly installing the new version as <filename>cloudstack-agent</filename>.</para>
                            <programlisting language="Bash">$ sudo yum upgrade cloud-agent</programlisting>
                            <para>During the installation of <filename>cloudstack-agent</filename>, the RPM will copy your <filename>agent.properties</filename>, <filename>log4j-cloud.xml</filename>, and <filename>environment.properties</filename> from <filename>/etc/cloud/agent</filename> to <filename>/etc/cloudstack/agent</filename>.</para>
                        </listitem>
                        <listitem>
                            <para>Verify that the file <filename>/etc/cloudstack/agent/environment.properties</filename> has a line that reads:</para>
                            <programlisting language="Bash">paths.script=/usr/share/cloudstack-common</programlisting>
                            <para>If not, add the line.</para>
                        </listitem>
                        <listitem>
                            <para>Restart the agent:</para>
                            <programlisting language="Bash">
                                service cloud-agent stop
                                killall jsvc
                                service cloudstack-agent start
                            </programlisting>
                        </listitem>
                    </orderedlist>
                </listitem>
                <listitem id="correct-components-xml-22">
                    <para>If you have made changes to your existing copy of the file components.xml in your
                        previous-version CloudStack installation, the changes will be preserved in the upgrade.
                        However, you need to do the following steps to place these changes in a new version of
                        the file which is compatible with version 4.0.0-incubating.</para>
                    <note>
                        <para>How will you know whether you need to do this? If the upgrade output in the
                            previous step included a message like the following, then some custom content was
                            found in your old components.xml, and you need to merge the two files:</para>
                    </note>
                    <programlisting>warning: /etc/cloud/management/components.xml created as /etc/cloud/management/components.xml.rpmnew </programlisting>
                    <orderedlist numeration="loweralpha">
                        <listitem>
                            <para>Make a backup copy of your
                                <filename>/etc/cloud/management/components.xml</filename> file. For
                                example:</para>
                            <programlisting><prompt>#</prompt> <command>mv</command> <filename>/etc/cloud/management/components.xml</filename> <filename>/etc/cloud/management/components.xml-backup</filename></programlisting>
                        </listitem>
                        <listitem>
                            <para>Copy <filename>/etc/cloud/management/components.xml.rpmnew</filename> to create
                                a new <filename>/etc/cloud/management/components.xml</filename>:</para>
                            <programlisting><prompt>#</prompt> <command>cp</command> -ap <filename>/etc/cloud/management/components.xml.rpmnew</filename> <filename>/etc/cloud/management/components.xml</filename></programlisting>
                        </listitem>
                        <listitem>
                            <para>Merge your changes from the backup file into the new components.xml file.</para>
                            <programlisting><prompt>#</prompt> <command>vi</command> <filename>/etc/cloud/management/components.xml</filename>
                            </programlisting>
                        </listitem>
                    </orderedlist>
                </listitem>
                <listitem>
                    <para>After upgrading to 4.1, API clients are expected to send plain text passwords for login and user creation, instead of MD5 hash. Incase, api client changes are not acceptable, following changes are to be made for backward compatibility:</para>
                    <para>Modify componentsContext.xml, and make PlainTextUserAuthenticator as the default authenticator (1st entry in the userAuthenticators adapter list is default)</para>
                    <programlisting language="XML">
&lt;!-- Security adapters --&gt;
&lt;bean id="userAuthenticators" class="com.cloud.utils.component.AdapterList"&gt;
  &lt;property name="Adapters"&gt;
    &lt;list&gt;
      &lt;ref bean="PlainTextUserAuthenticator"/&gt;
      &lt;ref bean="MD5UserAuthenticator"/&gt;
      &lt;ref bean="LDAPUserAuthenticator"/&gt;
    &lt;/list&gt;
  &lt;/property&gt;
&lt;/bean&gt;
                    </programlisting>
                    <para>PlainTextUserAuthenticator works the same way MD5UserAuthenticator worked prior to 4.1.</para>
                </listitem>
                <listitem>
                    <para>If you have made changes to your existing copy of the
                        <filename>/etc/cloud/management/db.properties</filename> file in your previous-version
                        CloudStack installation, the changes will be preserved in the upgrade. However, you need
                        to do the following steps to place these changes in a new version of the file which is
                        compatible with version 4.0.0-incubating.</para>
                    <orderedlist>
                        <listitem>
                            <para>Make a backup copy of your file
                                <filename>/etc/cloud/management/db.properties</filename>. For example:</para>
                            <programlisting><prompt>#</prompt> <command>mv</command> <filename>/etc/cloud/management/db.properties</filename> <filename>/etc/cloud/management/db.properties-backup</filename></programlisting>
                        </listitem>
                        <listitem>
                            <para>Copy <filename>/etc/cloud/management/db.properties.rpmnew</filename> to create a
                                new <filename>/etc/cloud/management/db.properties</filename>:</para>
                            <programlisting><prompt>#</prompt> <command>cp</command> -ap <filename>/etc/cloud/management/db.properties.rpmnew</filename> <filename>etc/cloud/management/db.properties</filename></programlisting>
                        </listitem>
                        <listitem>
                            <para>Merge your changes from the backup file into the new db.properties file.</para>
                            <programlisting><prompt>#</prompt> <command>vi</command> <filename>/etc/cloud/management/db.properties</filename></programlisting>
                        </listitem>
                    </orderedlist>
                </listitem>
                <listitem>
                    <para>On the management server node, run the following command. It is recommended that you
                        use the command-line flags to provide your own encryption keys. See Password and Key
                        Encryption in the Installation Guide.</para>
                    <programlisting><prompt>#</prompt> <command>cloud-setup-encryption</command> -e <replaceable>encryption_type</replaceable> -m <replaceable>management_server_key</replaceable> -k <replaceable>database_key</replaceable></programlisting>
                    <para>When used without arguments, as in the following example, the default encryption
                        type and keys will be used:</para>
                    <itemizedlist>
                        <listitem>
                            <para>(Optional) For encryption_type, use file or web to indicate the technique used
                                to pass in the database encryption password. Default: file.</para>
                        </listitem>
                        <listitem>
                            <para>(Optional) For management_server_key, substitute the default key that is used to
                                encrypt confidential parameters in the properties file. Default: password. It is
                                highly recommended that you replace this with a more secure value</para>
                        </listitem>
                        <listitem>
                            <para>(Optional) For database_key, substitute the default key that is used to encrypt
                                confidential parameters in the CloudStack database. Default: password. It is highly
                                recommended that you replace this with a more secure value.</para>
                        </listitem>
                    </itemizedlist>
                </listitem>
                <listitem>
                    <para>Repeat steps 10 - 14 on every management server node. If you provided your own
                        encryption key in step 14, use the same key on all other management servers.</para>
                </listitem>
                <listitem>
                    <para>Start the first Management Server. Do not start any other Management Server nodes
                        yet.</para>
                    <programlisting language="Bash"><prompt>#</prompt> service cloudstack-management start</programlisting>
                    <para>Wait until the databases are upgraded. Ensure that the database upgrade is complete.
                        You should see a message like "Complete! Done." After confirmation, start the other
                        Management Servers one at a time by running the same command on each node.</para>
                </listitem>
                <listitem>
                    <para>Start all Usage Servers (if they were running on your previous version). Perform
                        this on each Usage Server host.</para>
                    <programlisting language="Bash"><prompt>#</prompt> service cloudstack-usage start</programlisting>
                </listitem>
                <listitem>
                    <para>(KVM only) Additional steps are required for each KVM host. These steps will not
                        affect running guests in the cloud. These steps are required only for clouds using KVM
                        as hosts and only on the KVM hosts.</para>
                    <orderedlist numeration="loweralpha">
                        <listitem>
                            <para> Configure your CloudStack package repositories as outlined in the Installation
                                Guide </para>
                        </listitem>
                        <listitem>
                            <para>Stop the running agent.</para>
                            <programlisting># service cloud-agent stop</programlisting>
                        </listitem>
                        <listitem>
                            <para>Update the agent software with one of the following command sets as
                                appropriate.</para>
                            <programlisting><prompt>#</prompt> <command>yum</command> update cloud*</programlisting>
                            <programlisting>
                                <prompt>#</prompt> <command>apt-get</command> update
                                <prompt>#</prompt> <command>apt-get</command> upgrade cloud*
                            </programlisting>
                        </listitem>
                        <listitem>
                            <para>Start the agent.</para>
                            <programlisting># service cloudstack-agent start</programlisting>
                        </listitem>
                        <listitem>
                            <para> Copy the contents of the <filename>agent.properties</filename> file to the new
                                <filename>agent.properties</filename> file by using the following command</para>
                            <programlisting><command>sed</command> -i 's/com.cloud.agent.resource.computing.LibvirtComputingResource/com.cloud.hypervisor.kvm.resource.LibvirtComputingResource/g' <filename>/etc/cloud/agent/agent.properties</filename></programlisting>
                        </listitem>
                        <listitem>
                            <para>Start the cloud agent and cloud management services.</para>
                        </listitem>
                        <listitem>
                            <para>When the Management Server is up and running, log in to the CloudStack UI and
                                restart the virtual router for proper functioning of all the features.</para>
                        </listitem>
                    </orderedlist>
                </listitem>
                <listitem>
                    <para>Log in to the CloudStack UI as admin, and check the status of the hosts. All hosts
                        should come to Up state (except those that you know to be offline). You may need to wait
                        20 or 30 minutes, depending on the number of hosts.</para>
                    <para>Do not proceed to the next step until the hosts show in the Up state. If the hosts
                        do not come to the Up state, contact support.</para>
                </listitem>
                <listitem>
                    <para>Run the following script to stop, then start, all Secondary Storage VMs, Console
                        Proxy VMs, and virtual routers.</para>
                    <orderedlist numeration="loweralpha">
                        <listitem>
                            <para>Run the command once on one management server. Substitute your own IP address of
                                the MySQL instance, the MySQL user to connect as, and the password to use for that
                                user. In addition to those parameters, provide the "-c" and "-r" arguments. For
                                example:</para>
                            <programlisting><prompt>#</prompt> <command>nohup cloud-sysvmadm</command> -d <replaceable>192.168.1.5</replaceable> -u cloud -p <replaceable>password</replaceable> -c -r > sysvm.log 2>&amp;1 &amp;
                                <prompt>#</prompt> <command>tail</command> -f <filename>sysvm.log</filename></programlisting>
                            <para>This might take up to an hour or more to run, depending on the number of
                                accounts in the system.</para>
                        </listitem>
                        <listitem>
                            <para>After the script terminates, check the log to verify correct execution:</para>
                            <programlisting><prompt>#</prompt> <command>tail</command> -f <filename>sysvm.log</filename></programlisting>
                            <para>The content should be like the following:</para>
                            <programlisting>
                                Stopping and starting 1 secondary storage vm(s)...
                                Done stopping and starting secondary storage vm(s)
                                Stopping and starting 1 console proxy vm(s)...
                                Done stopping and starting console proxy vm(s).
                                Stopping and starting 4 running routing vm(s)...
                                Done restarting router(s).
                            </programlisting>
                        </listitem>
                    </orderedlist>
                </listitem>
                <listitem>
                    <para>If you would like additional confirmation that the new system VM templates were
                        correctly applied when these system VMs were rebooted, SSH into the System VM and check
                        the version.</para>
                    <para>Use one of the following techniques, depending on the hypervisor.</para>
                    <formalpara>
                        <title>XenServer or KVM:</title>
                        <para>SSH in by using the link local IP address of the system VM. For example, in the
                            command below, substitute your own path to the private key used to log in to the
                            system VM and your own link local IP.</para>
                    </formalpara>
                    <para>Run the following commands on the XenServer or KVM host on which the system VM is
                        present:</para>
                    <programlisting><prompt>#</prompt> <command>ssh</command> -i <replaceable>private-key-path</replaceable> <replaceable>link-local-ip</replaceable> -p 3922
                        # cat /etc/cloudstack-release</programlisting>
                    <para>The output should be like the following:</para>
                    <programlisting>Cloudstack Release 4.0.0-incubating Mon Oct 9 15:10:04 PST 2012</programlisting>
                    <formalpara>
                        <title>ESXi</title>
                        <para>SSH in using the private IP address of the system VM. For example, in the command
                            below, substitute your own path to the private key used to log in to the system VM and
                            your own private IP.</para>
                    </formalpara>
                    <para>Run the following commands on the Management Server:</para>
                    <programlisting><prompt>#</prompt> <command>ssh</command> -i <replaceable>private-key-path</replaceable> <replaceable>private-ip</replaceable> -p 3922
                        <prompt>#</prompt> <command>cat</command> <filename>/etc/cloudstack-release</filename>
                    </programlisting>
                    <para>The output should be like the following:</para>
                    <programlisting>Cloudstack Release 4.0.0-incubating Mon Oct 9 15:10:04 PST 2012</programlisting>
                </listitem>
                <listitem>
                    <para>If needed, upgrade all Citrix XenServer hypervisor hosts in your cloud to a version
                        supported by CloudStack 4.0.0-incubating. The supported versions are XenServer 5.6 SP2
                        and 6.0.2. Instructions for upgrade can be found in the CloudStack 4.0.0-incubating
                        Installation Guide.</para>
                </listitem>
                <listitem>
                    <para>Apply the XenServer hotfix XS602E003 (and any other needed hotfixes) to XenServer
                        v6.0.2 hypervisor hosts.</para>
                    <orderedlist numeration="loweralpha">
                        <listitem>
                            <para>Disconnect the XenServer cluster from CloudStack.</para>
                            <para>In the left navigation bar of the CloudStack UI, select Infrastructure. Under
                                Clusters, click View All. Select the XenServer cluster and click Actions -
                                Unmanage.</para>
                            <para>This may fail if there are hosts not in one of the states Up, Down,
                                Disconnected, or Alert. You may need to fix that before unmanaging this
                                cluster.</para>
                            <para>Wait until the status of the cluster has reached Unmanaged. Use the CloudStack
                                UI to check on the status. When the cluster is in the unmanaged state, there is no
                                connection to the hosts in the cluster.</para>
                        </listitem>
                        <listitem>
                            <para>To clean up the VLAN, log in to one XenServer host and run:</para>
                            <programlisting>/opt/xensource/bin/cloud-clean-vlan.sh</programlisting>
                        </listitem>
                        <listitem>
                            <para>Prepare the upgrade by running the following on one XenServer host:</para>
                            <programlisting>/opt/xensource/bin/cloud-prepare-upgrade.sh</programlisting>
                            <para>If you see a message like "can't eject CD", log in to the VM and umount the CD,
                                then run this script again.</para>
                        </listitem>
                        <listitem>
                            <para>Upload the hotfix to the XenServer hosts. Always start with the Xen pool master,
                                then the slaves. Using your favorite file copy utility (e.g. WinSCP), copy the
                                hotfixes to the host. Place them in a temporary folder such as /root or /tmp. </para>
                            <para>On the Xen pool master, upload the hotfix with this command:</para>
                            <programlisting>xe patch-upload file-name=XS602E003.xsupdate</programlisting>
                            <para>Make a note of the output from this command, which is a UUID for the hotfix
                                file. You'll need it in another step later.</para>
                            <note>
                                <para>(Optional) If you are applying other hotfixes as well, you can repeat the
                                    commands in this section with the appropriate hotfix number. For example,
                                    XS602E004.xsupdate.</para>
                            </note>
                        </listitem>
                        <listitem>
                            <para>Manually live migrate all VMs on this host to another host. First, get a list of
                                the VMs on this host:</para>
                            <programlisting># xe vm-list</programlisting>
                            <para>Then use this command to migrate each VM. Replace the example host name and VM
                                name with your own:</para>
                            <programlisting><prompt>#</prompt> <command>xe</command> vm-migrate live=true host=<replaceable>host-name</replaceable> vm=<replaceable>VM-name</replaceable></programlisting>
                            <note>
                                <title>Troubleshooting</title>
                                <para>If you see a message like "You attempted an operation on a VM which requires
                                    PV drivers to be installed but the drivers were not detected," run:</para>
                                <para><command>/opt/xensource/bin/make_migratable.sh
                                        b6cf79c8-02ee-050b-922f-49583d9f1a14</command>.</para>
                            </note>
                        </listitem>
                        <listitem>
                            <para>Apply the hotfix. First, get the UUID of this host:</para>
                            <para><command># xe host-list</command></para>
                            <para>Then use the following command to apply the hotfix. Replace the example host
                                UUID with the current host ID, and replace the hotfix UUID with the output from the
                                patch-upload command you ran on this machine earlier. You can also get the hotfix
                                UUID by running xe patch-list. </para>
                            <para><command>xe patch-apply host-uuid=<replaceable>host-uuid</replaceable>
                                    uuid=<replaceable>hotfix-uuid</replaceable></command></para>
                        </listitem>
                        <listitem>
                            <para>Copy the following files from the CloudStack Management Server to the
                                host.</para>
                            <informaltable>
                                <tgroup cols="2" align="left" colsep="1" rowsep="1">
                                    <colspec colwidth="1*" colname="1" colnum="1"/>
                                    <colspec colwidth="2*" colname="2" colnum="2"/>
                                    <thead>
                                        <row>
                                            <entry><para>Copy from here...</para></entry>
                                            <entry><para>...to here</para></entry>
                                        </row>
                                    </thead>
                                    <tbody>
                                        <row>
                                            <entry><para><filename>/usr/share/cloudstack-common/scripts/vm/hypervisor/xenserver/xenserver60/NFSSR.py</filename></para></entry>
                                            <entry><para><filename>/opt/xensource/sm/NFSSR.py</filename></para></entry>
                                        </row>
                                        <row>
                                            <entry><para><filename>/usr/share/cloudstack-common/scripts/vm/hypervisor/xenserver/setupxenserver.sh</filename></para></entry>
                                            <entry><para><filename>/opt/xensource/bin/setupxenserver.sh</filename></para></entry>
                                        </row>
                                        <row>
                                            <entry><para><filename>/usr/share/cloudstack-common/scripts/vm/hypervisor/xenserver/make_migratable.sh</filename></para></entry>
                                            <entry><para><filename>/opt/xensource/bin/make_migratable.sh</filename></para></entry>
                                        </row>
                                    </tbody>
                                </tgroup>
                            </informaltable>
                        </listitem>
                        <listitem>
                            <para>(Only for hotfixes XS602E005 and XS602E007) You need to apply a new Cloud
                                Support Pack.</para>
                            <itemizedlist>
                                <listitem>
                                    <para>Download the CSP software onto the XenServer host from one of the following
                                        links:</para>
                                    <para>For hotfix XS602E005: <ulink
                                            url="http://coltrane.eng.hq.xensource.com/release/XenServer-6.x/XS-6.0.2/hotfixes/XS602E005/56710/xe-phase-2/xenserver-cloud-supp.tgz"
                                            >http://coltrane.eng.hq.xensource.com/release/XenServer-6.x/XS-6.0.2/hotfixes/XS602E005/56710/xe-phase-2/xenserver-cloud-supp.tgz</ulink></para>
                                    <para>For hotfix XS602E007: <ulink
                                            url="http://coltrane.eng.hq.xensource.com/release/XenServer-6.x/XS-6.0.2/hotfixes/XS602E007/57824/xe-phase-2/xenserver-cloud-supp.tgz"
                                            >http://coltrane.eng.hq.xensource.com/release/XenServer-6.x/XS-6.0.2/hotfixes/XS602E007/57824/xe-phase-2/xenserver-cloud-supp.tgz</ulink></para>
                                </listitem>
                                <listitem>
                                    <para>Extract the file:</para>
                                    <para><command># tar xf xenserver-cloud-supp.tgz</command></para>
                                </listitem>
                                <listitem>
                                    <para>Run the following script:</para>
                                    <para><command># xe-install-supplemental-pack
                                            xenserver-cloud-supp.iso</command></para>
                                </listitem>
                                <listitem>
                                    <para>If the XenServer host is part of a zone that uses basic networking, disable
                                        Open vSwitch (OVS):</para>
                                    <para><command># xe-switch-network-backend bridge</command></para>
                                </listitem>
                            </itemizedlist>
                        </listitem>
                        <listitem>
                            <para>Reboot this XenServer host.</para>
                        </listitem>
                        <listitem>
                            <para>Run the following:</para>
                            <para><command>/opt/xensource/bin/setupxenserver.sh</command></para>
                            <note>
                                <para>If the message "mv: cannot stat `/etc/cron.daily/logrotate': No such file or
                                    directory" appears, you can safely ignore it.</para>
                            </note>
                        </listitem>
                        <listitem>
                            <para>Run the following:</para>
                            <para><command>for pbd in `xe pbd-list currently-attached=false| grep ^uuid | awk
                                    '{print $NF}'`; do xe pbd-plug uuid=$pbd ; </command>
                            </para>
                        </listitem>
                        <listitem>
                            <para>On each slave host in the Xen pool, repeat these steps, starting from "manually
                                live migrate VMs."</para>
                        </listitem>
                    </orderedlist>
                </listitem>
            </orderedlist>
        </section>
    </chapter>
    <chapter id="api-changes-4.1">
        <title>API Changes in 4.1.1</title>
        <section id="api-changes-new-4.1">
            <title>New API commands in 4.1</title>
            <para>CloudStack 4.1.1 is a maintenance release, and thus there are no new API commands.</para>
        </section>
        <section id="api-changes-changed-4.1">
            <title>Changed API commands in 4.1</title>
            <para>CloudStack 4.1.1 is a maintenance release, and thus there are no new API commands.</para>
        </section>
    </chapter>
</book>
